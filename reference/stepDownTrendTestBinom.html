<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Step-Down Trend Test for Binomial Data — stepDownTrendTestBinom • drcHelper</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Step-Down Trend Test for Binomial Data — stepDownTrendTestBinom"><meta name="description" content="Performs a step-down trend test procedure on binomial data using either the
Cochran-Armitage test or Rao-Scott corrected Cochran-Armitage test."><meta property="og:description" content="Performs a step-down trend test procedure on binomial data using either the
Cochran-Armitage test or Rao-Scott corrected Cochran-Armitage test."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">drcHelper</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started"><li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/Example_Analysis_Workflow.html">Example Analysis Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/drcHelper.html">Example ECx Helper Functions Usage</a></li>
    <li><a class="dropdown-item" href="../articles/Dunnetts_Test_for_Data_with_Hierarchical_Structure.html">Example NOEC Helper Functions Usage</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_drc.html">Using DRC and BMD</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_oecd201.html">Example DRC - OECD 201</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-regulatory-stats" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Regulatory Stats</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-regulatory-stats"><li><a class="dropdown-item" href="../articles/NOEC_Methods.html">NOEC Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/Limit-Test.html">Limit Test Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/EFSA-Criteria.html">EFSA Criteria and Other Reliability Criteria</a></li>
    <li><a class="dropdown-item" href="../articles/Example_RSCABS.html">RSCABS</a></li>
    <li><a class="dropdown-item" href="../articles/Trend-Testing.html">Trend Testing</a></li>
    <li><a class="dropdown-item" href="../articles/NOEC_ECx_BMD.html">NOEC ECx and BMD</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Quantal-Data.html">Quantal Data</a></li>
    <li><a class="dropdown-item" href="../articles/Ordinal-Data.html">Ordinal Data</a></li>
    <li><a class="dropdown-item" href="../articles/Count_Data.html">Count Data</a></li>
    <li><a class="dropdown-item" href="../articles/LMM-GLMM-and-GAMM.html">Understanding Mixed Models</a></li>
    <li><a class="dropdown-item" href="../articles/Normality-Check.html">Normality Check</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>More Topics</h6></li>
    <li><a class="dropdown-item" href="../articles/Examples%20using%20NLS.html">NLS</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_using_drda.html">drda</a></li>
    <li><a class="dropdown-item" href="../articles/TSK_method.html">TSK method</a></li>
    <li><a class="dropdown-item" href="../articles/MQJT.html">MQJT</a></li>
    <li><a class="dropdown-item" href="../articles/Advanced_Fitting-a-biphasic-dose-reponse-model.html">Fitting A biphasic dose response model</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-validation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Validation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-validation"><li><a class="dropdown-item" href="../articles/System_Testing.html">System Testing</a></li>
    <li><a class="dropdown-item" href="../articles/Verification_which_JT.html">Which JT test to use</a></li>
    <li><a class="dropdown-item" href="../articles/Test-Guidelines.html">Study Types and Templates</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayer-Group/drcHelper/issues/new?template=Blank+issue" aria-label="New Issue"><span class="fa fa-bug"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayer-Group/drcHelper" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Step-Down Trend Test for Binomial Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/Bayer-Group/drcHelper/blob/main/R/stepdown_binom.R" class="external-link"><code>R/stepdown_binom.R</code></a></small>
      <div class="d-none name"><code>stepDownTrendTestBinom.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs a step-down trend test procedure on binomial data using either the
Cochran-Armitage test or Rao-Scott corrected Cochran-Armitage test.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stepDownTrendTestBinom</span><span class="op">(</span></span>
<span>  <span class="va">successes</span>,</span>
<span>  <span class="va">totals</span>,</span>
<span>  <span class="va">doses</span>,</span>
<span>  alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"two.sided"</span>, <span class="st">"greater"</span>, <span class="st">"less"</span><span class="op">)</span>,</span>
<span>  rao_scott <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  phi <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-successes">successes<a class="anchor" aria-label="anchor" href="#arg-successes"></a></dt>
<dd><p>Numeric vector of successes (e.g., number of survivors).</p></dd>


<dt id="arg-totals">totals<a class="anchor" aria-label="anchor" href="#arg-totals"></a></dt>
<dd><p>Numeric vector of total observations (e.g., total organisms).</p></dd>


<dt id="arg-doses">doses<a class="anchor" aria-label="anchor" href="#arg-doses"></a></dt>
<dd><p>Numeric vector of dose levels corresponding to each observation.</p></dd>


<dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>Character string specifying the alternative hypothesis.
Must be one of "two.sided" (default), "greater", or "less".</p></dd>


<dt id="arg-rao-scott">rao_scott<a class="anchor" aria-label="anchor" href="#arg-rao-scott"></a></dt>
<dd><p>Logical indicating whether to apply Rao-Scott correction for
overdispersion (default: FALSE).</p></dd>


<dt id="arg-phi">phi<a class="anchor" aria-label="anchor" href="#arg-phi"></a></dt>
<dd><p>Overdispersion parameter for Rao-Scott correction. If NULL (default),
it will be estimated from the data.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with class "stepDownTrendBinom" containing:</p>
<dl><dt>method</dt>
<dd><p>Description of the test performed</p></dd>

<dt>data.name</dt>
<dd><p>Description of the data</p></dd>

<dt>p.value</dt>
<dd><p>Matrix of p-values for each step</p></dd>

<dt>statistic</dt>
<dd><p>Matrix of test statistics for each step</p></dd>

<dt>alternative</dt>
<dd><p>The alternative hypothesis</p></dd>

<dt>doses</dt>
<dd><p>The dose levels used</p></dd>

<dt>noec</dt>
<dd><p>The No Observed Effect Concentration (highest dose with no significant effect)</p></dd>

<dt>loec</dt>
<dd><p>The Lowest Observed Effect Concentration (lowest dose with significant effect)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The step-down procedure starts with all dose groups and sequentially removes the
highest dose until no significant trend is detected or only two groups remain.
This helps identify the lowest dose at which a significant effect occurs.</p>
<p>The Cochran-Armitage test is appropriate for detecting trends in binomial proportions
across ordered groups. The Rao-Scott correction adjusts for potential overdispersion
in binomial data, which is common in toxicological studies.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example with simulated data</span></span></span>
<span class="r-in"><span><span class="va">successes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">18</span>, <span class="fl">15</span>, <span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">totals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">doses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run step-down test with Cochran-Armitage</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">stepDownTrendTestBinom</span><span class="op">(</span><span class="va">successes</span>, <span class="va">totals</span>, <span class="va">doses</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step-down Cochran-Armitage test for trend </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data: successes out of totals at doses 0, 1, 2, 5, 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step-down results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Doses_Included Statistic      P_Value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 1 0, 1, 2, 5, 10 -5.746549 9.108323e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 2     0, 1, 2, 5 -4.090480 4.304814e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 3        0, 1, 2 -2.462659 1.379110e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 4           0, 1 -1.450953 1.467931e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alternative hypothesis: two.sided </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOEC: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOEC: 2 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run with Rao-Scott correction</span></span></span>
<span class="r-in"><span><span class="va">result_rs</span> <span class="op">&lt;-</span> <span class="fu">stepDownTrendTestBinom</span><span class="op">(</span><span class="va">successes</span>, <span class="va">totals</span>, <span class="va">doses</span>, rao_scott <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_rs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step-down Rao-Scott corrected Cochran-Armitage test for trend </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data: successes out of totals at doses 0, 1, 2, 5, 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step-down results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Doses_Included Statistic    P_Value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 1 0, 1, 2, 5, 10 -1.962895 0.04965834</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 2     0, 1, 2, 5 -1.720567 0.08532934</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 3        0, 1, 2 -1.404879 0.16005735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step 4           0, 1 -1.000000 0.31731051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alternative hypothesis: two.sided </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOEC: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOEC: 10 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhenglei Gao, Sean Ryan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>


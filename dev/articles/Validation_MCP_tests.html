<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Verification and Validation of NOEC Derivation by MCP • drcHelper</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Verification and Validation of NOEC Derivation by MCP">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">drcHelper</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.0.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started">
<li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/Example_Analysis_Workflow.html">Example Analysis Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/drcHelper.html">Example ECx Helper Functions Usage</a></li>
    <li><a class="dropdown-item" href="../articles/Dunnetts_Test_for_Data_with_Hierarchical_Structure.html">Example NOEC Helper Functions Usage</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_drc.html">Using DRC and BMD</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_oecd201.html">Example DRC - OECD 201</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-regulatory-stats" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Regulatory Stats</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-regulatory-stats">
<li><a class="dropdown-item" href="../articles/NOEC_Methods.html">NOEC Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/Limit-Test.html">Limit Test Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/EFSA-Criteria.html">EFSA Criteria and Other Reliability Criteria</a></li>
    <li><a class="dropdown-item" href="../articles/Example_RSCABS.html">RSCABS</a></li>
    <li><a class="dropdown-item" href="../articles/Trend-Testing.html">Trend Testing</a></li>
    <li><a class="dropdown-item" href="../articles/NOEC_ECx_BMD.html">NOEC ECx and BMD</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Quantal-Data.html">Quantal Data</a></li>
    <li><a class="dropdown-item" href="../articles/Ordinal-Data.html">Ordinal Data</a></li>
    <li><a class="dropdown-item" href="../articles/Count_Data.html">Count Data</a></li>
    <li><a class="dropdown-item" href="../articles/LMM-GLMM-and-GAMM.html">Understanding Mixed Models</a></li>
    <li><a class="dropdown-item" href="../articles/Normality-Check.html">Normality Check</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>More Topics</h6></li>
    <li><a class="dropdown-item" href="../articles/Examples%20using%20NLS.html">NLS</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_using_drda.html">drda</a></li>
    <li><a class="dropdown-item" href="../articles/TSK_method.html">TSK method</a></li>
    <li><a class="dropdown-item" href="../articles/MQJT.html">MQJT</a></li>
    <li><a class="dropdown-item" href="../articles/Advanced_Fitting-a-biphasic-dose-reponse-model.html">Fitting A biphasic dose response model</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-validation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Validation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-validation">
<li><a class="dropdown-item" href="../articles/System_Testing.html">System Testing</a></li>
    <li><a class="dropdown-item" href="../articles/Verification_which_JT.html">Which JT test to use</a></li>
    <li><a class="dropdown-item" href="../articles/Test-Guidelines.html">Study Types and Templates</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayer-Group/drcHelper/issues/new?template=Blank+issue" aria-label="New Issue"><span class="fa fa-bug"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayer-Group/drcHelper" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Verification and Validation of NOEC Derivation by MCP</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Bayer-Group/drcHelper/blob/main/vignettes/articles/Validation_MCP_tests.Rmd" class="external-link"><code>vignettes/articles/Validation_MCP_tests.Rmd</code></a></small>
      <div class="d-none name"><code>Validation_MCP_tests.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="multiple-comparison-tests">Multiple Comparison Tests<a class="anchor" aria-label="anchor" href="#multiple-comparison-tests"></a>
</h2>
<p>In this article we compare the different functions from various
packages to perform the same task, demonstrating the differences and
similarities. We implemented a function
<code>combine_multiple_comparisons</code> for comparing different
results. This implementation provides a comprehensive set of functions
for standardizing and combining multiple comparison test results in dose
response data analysis. The functions handle various test
implementations and provide consistent output formats for easy
comparison.</p>
<p>Note that for trend tests, the null hypotheses are different from
those many-to-one pairwise comparisons. Direct comparison is not very
fair. However, the NOEC calculation can be based on both trend tests and
many-to-one pairwise tests.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bayer-group.github.io/drcHelper/index.html">drcHelper</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: drc</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 'drc' has been loaded.</span></span>
<span><span class="co">#&gt; Please cite R and 'drc' if used for a publication,</span></span>
<span><span class="co">#&gt; for references type 'citation()' and 'citation('drc')'.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'drc'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     gaussian, getInitial</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dunnetts-test">Dunnett’s Test<a class="anchor" aria-label="anchor" href="#dunnetts-test"></a>
</h2>
<p><code>glht</code> pulls its P-values out of a multivariate t
distribution. mvtnorm::pmvt is called with the observed t statistics and
correlation matrix (actual code here). DescTools::DunnettTest does
roughly the same. emmeans uses a close approximation to the Dunnett
adjustment.</p>
</div>
<div class="section level2">
<h2 id="williams-test">Williams’ Test<a class="anchor" aria-label="anchor" href="#williams-test"></a>
</h2>
<p>PMCMRplus::williamsTest produces more accurate results since it is
based on the isotonic regression.</p>
<p>Both functions use tabulated critical values provided by Williams
(only for a=0.05).</p>
<p>The <code>williamsTest</code> function from
<strong>PMCMRplus</strong> produces the same results as in
<code>williamsTest_JG</code> in general. However,
<code>williamsTest</code> function from <strong>PMCMRplus</strong> use
multivariate t distribution to calculate p-values.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">106</span>, <span class="fl">114</span>, <span class="fl">116</span>, <span class="fl">127</span>, <span class="fl">145</span>,<span class="fl">110</span>, <span class="fl">125</span>, <span class="fl">143</span>, <span class="fl">148</span>, <span class="fl">151</span>,</span>
<span><span class="fl">136</span>, <span class="fl">139</span>, <span class="fl">149</span>, <span class="fl">160</span>, <span class="fl">174</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"I"</span>, <span class="st">"II"</span><span class="op">)</span></span>
<span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu">PMCMRplus</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PMCMRplus/man/williamsTest.html" class="external-link">williamsTest</a></span><span class="op">(</span><span class="va">x</span> <span class="op">~</span> <span class="va">g</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/summaryZG.html">summaryZG</a></span><span class="op">(</span><span class="va">res1</span><span class="op">)</span></span>
<span><span class="co">#&gt;                t'-value df t'-crit decision alpha</span></span>
<span><span class="co">#&gt; mu1 - ctr &lt;= 0    1.357 12   1.782   accept  0.05</span></span>
<span><span class="co">#&gt; mu2 - ctr &lt;= 0    2.950 12   1.873   reject  0.05</span></span>
<span><span class="fu"><a href="../reference/williamsTest_JG.html">williamsTest_JG</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>treatment_var <span class="op">=</span> <span class="va">g</span>,response_var<span class="op">=</span><span class="va">x</span><span class="op">)</span>,<span class="st">"response_var"</span>,<span class="st">"treatment_var"</span>,direction<span class="op">=</span><span class="st">"increasing"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   treatment_var Y.Tilde    Y0 Se.Diff DF  Will TCrit Signif</span></span>
<span><span class="co">#&gt; 2            II   151.6 121.6   10.17 12 2.950 1.873      *</span></span>
<span><span class="co">#&gt; 1             I   135.4 121.6   10.17 12 1.357 1.782      .</span></span></code></pre></div>
<div class="section level3">
<h3 id="many-to-one-with-welcht-t-test">Many-to-One with Welch’t t-test<a class="anchor" aria-label="anchor" href="#many-to-one-with-welcht-t-test"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="tips">Tips<a class="anchor" aria-label="anchor" href="#tips"></a>
</h2>
<p>Note that to install “PMCMRplus” properly under ubuntu (Platform:
x86_64-pc-linux-gnu), you need probably install libmpfr-dev first.</p>
<pre><code>sudo apt-get install libmpfr-dev</code></pre>
</div>
<div class="section level2">
<h2 id="other-packages">Other packages<a class="anchor" aria-label="anchor" href="#other-packages"></a>
</h2>
<p>In my own analysis, I also use <strong>rstatix</strong> very often,
as it provide a workflow for tidy evaluations, unlike other
packages.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhenglei Gao, Sean Ryan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>

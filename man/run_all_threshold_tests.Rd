% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RSCABS_AO.R
\name{run_all_threshold_tests}
\alias{run_all_threshold_tests}
\title{Run Rao-Scott Adjusted Cochran-Armitage Trend Tests for All Thresholds}
\usage{
run_all_threshold_tests(
  data,
  max_score = NULL,
  min_score = 1,
  score_cols = NULL,
  treatment_col = "tmt",
  replicate_col = "tank",
  total_col = "total",
  direction = "greater",
  alternative = "two.sided",
  include_fisher = TRUE
)
}
\arguments{
\item{data}{A data frame containing fish injury data}

\item{max_score}{Maximum score value to consider (default: NULL, auto-detected)}

\item{min_score}{Minimum score value to consider (default: 1)}

\item{score_cols}{Character vector of column names containing injury scores (default: NULL, auto-detected)}

\item{treatment_col}{Name of the column containing treatment groups (default: "tmt")}

\item{replicate_col}{Name of the column containing tank/replicate IDs (default: "tank")}

\item{total_col}{Name of the column containing total counts (default: "total")}

\item{direction}{Character string indicating threshold direction: "greater" for \\ge threshold,
"less" for \\le threshold (default: "greater")}

\item{alternative}{Character string specifying the alternative hypothesis:
"two.sided" (default), "greater" (proportion increases with treatment level),
or "less" (proportion decreases with treatment level)}

\item{include_fisher}{Logical indicating whether to use Fisher's exact test when RSCA fails (default: TRUE)}
}
\value{
A list containing:
\item{results}{Data frame with test results for each threshold}
\item{proportions}{Data frame with proportions of affected fish by treatment and threshold}
\item{detailed_results}{List of detailed results for each threshold}
}
\description{
This function performs the Rao-Scott adjusted Cochran-Armitage trend test for
multiple injury thresholds, providing a comprehensive analysis of dose-response
relationships at different severity levels.
}
\examples{
# Example data
fish_data <- data.frame(
  tmt = rep(c("Control", "Low", "Medium", "High"), each = 3),
  tank = paste0(rep(c("Control", "Low", "Medium", "High"), each = 3),
                rep(1:3, times = 4)),
  S0 = c(8,7,9, 6,5,7, 4,5,3, 2,3,1),
  S1 = c(2,2,1, 3,4,2, 4,3,5, 4,3,5),
  S2 = c(0,1,0, 1,1,1, 2,2,1, 3,3,3),
  S3 = c(0,0,0, 0,0,0, 0,0,1, 1,1,1),
  S4 = c(0,0,0, 0,0,0, 0,0,0, 0,0,0),
  total = rep(10, 12)
)

# Run two-sided tests for all thresholds
all_results <- run_all_threshold_tests(fish_data)

# Run one-sided tests (proportion increases with treatment level)
all_results_greater <- run_all_threshold_tests(
  fish_data,
  alternative = "greater"
)

# View results table
print(all_results$results)
print(all_results_greater$results)

}

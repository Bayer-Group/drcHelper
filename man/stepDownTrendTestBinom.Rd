% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stepdown_binom.R
\name{stepDownTrendTestBinom}
\alias{stepDownTrendTestBinom}
\title{Step-Down Trend Test for Binomial Data}
\usage{
stepDownTrendTestBinom(
  successes,
  totals,
  doses,
  alternative = c("two.sided", "greater", "less"),
  rao_scott = FALSE,
  phi = NULL
)
}
\arguments{
\item{successes}{Numeric vector of successes (e.g., number of survivors).}

\item{totals}{Numeric vector of total observations (e.g., total organisms).}

\item{doses}{Numeric vector of dose levels corresponding to each observation.}

\item{alternative}{Character string specifying the alternative hypothesis.
Must be one of "two.sided" (default), "greater", or "less".}

\item{rao_scott}{Logical indicating whether to apply Rao-Scott correction for
overdispersion (default: FALSE).}

\item{phi}{Overdispersion parameter for Rao-Scott correction. If NULL (default),
it will be estimated from the data.}
}
\value{
A list with class "stepDownTrendBinom" containing:
\item{method}{Description of the test performed}
\item{data.name}{Description of the data}
\item{p.value}{Matrix of p-values for each step}
\item{statistic}{Matrix of test statistics for each step}
\item{alternative}{The alternative hypothesis}
\item{doses}{The dose levels used}
\item{noec}{The No Observed Effect Concentration (highest dose with no significant effect)}
\item{loec}{The Lowest Observed Effect Concentration (lowest dose with significant effect)}
}
\description{
Performs a step-down trend test procedure on binomial data using either the
Cochran-Armitage test or Rao-Scott corrected Cochran-Armitage test.
}
\details{
The step-down procedure starts with all dose groups and sequentially removes the
highest dose until no significant trend is detected or only two groups remain.
This helps identify the lowest dose at which a significant effect occurs.

The Cochran-Armitage test is appropriate for detecting trends in binomial proportions
across ordered groups. The Rao-Scott correction adjusts for potential overdispersion
in binomial data, which is common in toxicological studies.
}
\examples{
# Example with simulated data
successes <- c(20, 18, 15, 10, 5)
totals <- rep(20, 5)
doses <- c(0, 1, 2, 5, 10)

# Run step-down test with Cochran-Armitage
result <- stepDownTrendTestBinom(successes, totals, doses)
print(result)

# Run with Rao-Scott correction
result_rs <- stepDownTrendTestBinom(successes, totals, doses, rao_scott = TRUE)
print(result_rs)

}

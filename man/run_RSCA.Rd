% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RSCABS_AO.R
\name{run_RSCA}
\alias{run_RSCA}
\title{Run Rao-Scott Adjusted Cochran-Armitage Trend Test}
\usage{
run_RSCA(group, replicate, affected, total, correction = 0)
}
\arguments{
\item{group}{Vector of treatment group identifiers}

\item{replicate}{Vector of replicate/tank identifiers within treatment groups}

\item{affected}{Vector of counts of affected subjects (fish with injuries) in each replicate}

\item{total}{Vector of total subjects (fish) in each replicate}

\item{correction}{continuity correction when there is 1, default is 0, can be changed to 0.5.}
}
\value{
A list containing:
\item{interm_values}{A tibble with intermediate values from the Rao-Scott adjustment}
\item{Z}{The Z-statistic for the Cochran-Armitage trend test}
}
\description{
This function is a wrapper that performs the Rao-Scott adjusted Cochran-Armitage
trend test for clustered binary data.
}
\details{
This function combines the Rao-Scott adjustment and the Cochran-Armitage trend test
to analyze dose-response relationships in clustered data. It first calculates
adjusted values accounting for clustering, then uses these values to perform
the trend test.

The p-value can be calculated using: 2 * (1 - pnorm(abs(Z)))
}
\examples{
# Test for trend in injury rates across treatment groups
# Considering S1, S2, and S3 as "affected"
result <- run_RSCA(
  dat_bcs1$tmt,
  dat_bcs1$tank,
  dat_bcs1$S1 + dat_bcs1$S2 + dat_bcs1$S3,
  dat_bcs1$total
)

# View intermediate values
print(result$interm_values)

# View Z-statistic
print(result$Z)

# Calculate p-value
p_value <- 2 * (1 - pnorm(abs(result$Z)))
print(paste("p-value:", p_value))
}
\author{
Originally by Allen Olmstead
}

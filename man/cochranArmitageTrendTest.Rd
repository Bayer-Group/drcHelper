% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stepdown_binom.R
\name{cochranArmitageTrendTest}
\alias{cochranArmitageTrendTest}
\title{Cochran-Armitage Trend Test for Binomial Data}
\usage{
cochranArmitageTrendTest(
  successes,
  totals,
  doses,
  scoring = c("doses", "ranks", "log_doses", "equal_spaced"),
  alternative = c("two.sided", "greater", "less"),
  rao_scott = FALSE,
  phi = NULL,
  phi_method = c("simple", "trend_adjusted")
)
}
\arguments{
\item{successes}{Numeric vector of successes (e.g., number of survivors).}

\item{totals}{Numeric vector of total observations (e.g., total organisms).}

\item{doses}{Numeric vector of dose levels or scores corresponding to each observation.}

\item{scoring}{Method for defining trend}

\item{alternative}{Character string specifying the alternative hypothesis.
Must be one of "two.sided" (default), "greater", or "less".}

\item{rao_scott}{Logical indicating whether to apply Rao-Scott correction for
overdispersion (default: FALSE).}

\item{phi}{Overdispersion parameter for Rao-Scott correction. If NULL (default),
it will be estimated from the data.}

\item{phi_method}{simple without trend adjustment or trend_adjusted.}
}
\value{
A list containing:
\item{statistic}{Test statistic (Z score)}
\item{p.value}{P-value for the test}
\item{method}{Description of the test performed}
\item{alternative}{The alternative hypothesis}
\item{data.name}{Description of the data}
\item{phi}{Overdispersion parameter (only if rao_scott = TRUE)}
}
\description{
Performs a Cochran-Armitage test for trend in binomial proportions across
ordered groups, with an optional Rao-Scott correction for overdispersion.
}
\details{
The Cochran-Armitage test is used to detect trends in binomial proportions
across ordered groups. The test statistic follows a standard normal distribution
under the null hypothesis of no trend.

When rao_scott = TRUE, the function applies a correction for overdispersion,
which is often present in clustered binomial data. The correction divides the
test statistic by the square root of the estimated dispersion parameter.
}
\examples{
# Example with simulated data
successes <- c(20, 18, 15, 10, 5)
totals <- rep(20, 5)
doses <- c(0, 1, 2, 5, 10)

# Standard Cochran-Armitage test
result <- cochranArmitageTrendTest(successes, totals, doses)
print(result)

# With Rao-Scott correction
result_rs <- cochranArmitageTrendTest(successes, totals, doses, rao_scott = TRUE)
print(result_rs)

}

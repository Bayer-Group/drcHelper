<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An example: RSCABS for Histopath Data • drcHelper</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An example: RSCABS for Histopath Data">
<meta property="og:description" content="drcHelper">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">drcHelper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/Tutorial_drc_Helpers.html">Example Usage of drcHelper</a>
    </li>
    <li>
      <a href="../articles/Count_Data.html">Count Data</a>
    </li>
    <li>
      <a href="../articles/EFSA-Criteria.html">EFSA Criteria</a>
    </li>
    <li>
      <a href="../articles/Example_RSCABS_PTZ.html">PTZ</a>
    </li>
    <li>
      <a href="../articles/Examples%20using%20NLS.html">Using nls to fit arbitrary dose-response models</a>
    </li>
    <li>
      <a href="../articles/Examples_MCP.html">Examples of NOEC Derivation by MCP</a>
    </li>
    <li>
      <a href="../articles/Examples_drc.html">Examples_drc</a>
    </li>
    <li>
      <a href="../articles/Examples_oecd201.html">Examples_oecd201</a>
    </li>
    <li>
      <a href="../articles/Examples_using_drda.html">Examples using drda</a>
    </li>
    <li>
      <a href="../articles/Fitting-a-biphasic-dose-reponse-model.html">Fitting a biphasic dose-reponse model</a>
    </li>
    <li>
      <a href="../articles/MQJT.html">MQJT</a>
    </li>
    <li>
      <a href="../articles/Ordinal-Data.html">An example: RSCABS for Histopath Data</a>
    </li>
    <li>
      <a href="../articles/Quantal-Data.html">Quantal Data</a>
    </li>
    <li>
      <a href="../articles/TSK_method.html"> Spearman-Karber method</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Ordinal-Data_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="Ordinal-Data_files/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="Ordinal-Data_files/vis-9.1.0/vis-network.min.js"></script><script src="Ordinal-Data_files/visNetwork-binding-2.1.2/visNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>An example: RSCABS for Histopath Data</h1>
            
      
      
      <div class="hidden name"><code>Ordinal-Data.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>Allen Olmstead Ecotoxicologist</p>
<p>For the public consultation period on the EU <strong>prothioconazole
endocrine assessment</strong>, one of the studies of focus in the FSTRA
(fish short term reproduction assay). In particular there was a question
concerning the histopathology results (female oocyte atresia,
specifically) and whether they were statistically significant. In our
report, there is no formal statistical analysis of the data. I was asked
about the availability of approaches for this based on my past
postdoctoral experience at the EPA lab that developed many of the
endocrine assays. For histopath endpoints, the EPA used a Rao-Scott
Cochran-Armitage Trend Test By Slices (RSCABS, described in attached
paper).</p>
<p>Using this RSCABS procedure, I looked at the female oocyte atresia
data in R. The attached Excel file has the data and the other attached
pdf has my notes on this analysis. However, validation is needed if we
are to proceed with this approach in any external purpose.</p>
</div>
<div class="section level2">
<h2 id="an-example-of-performing-the-rao-scott-adjusted-cochran-armitage-trend-test-by-slices-">An example of performing the Rao-Scott Adjusted Cochran-Armitage
Trend Test by Slices.<a class="anchor" aria-label="anchor" href="#an-example-of-performing-the-rao-scott-adjusted-cochran-armitage-trend-test-by-slices-"></a>
</h2>
<p>RSCABS: designed to analyze histopathological results from standard
toxicology experiments, for example the MEOGRT.</p>
<p>Steps in the testing procedure:</p>
<p>1.The Cochran-Armitage (CA) trend test was used to test a set of
organisms for an increase in the presences (score &gt; 0) or absence
(score = 0) of an effect with an increase in the dose concentration of
the treatments. 2. The Rao-Scott (RS) adjustment controls for the
similarity in each experiment unit / apparatus (<em>e.g.</em>, fish
tank) by calculating an adjustment to the CA test statistic from
correlation of organisms within each apparatuses. 3. The by slices (BS)
part allows for testing at each severity score (<em>e.g.</em>, from 1 to
5) instead of just presences or absence. By slices works by splitting
the severity scores associated with an endpoint into
<strong>two</strong> groups based on the severity score being tested.
The RSCA test statistic is calculated based on these two groups. 4.
Carry out a step-down procedure by excluding the highest treatment level
in the analysis and recalculate the RSCA test statistic until the test
stats is not significant or there is only control group left.</p>
<div class="section level3">
<h3 id="notes-on-rscabs">Notes on RSCABS<a class="anchor" aria-label="anchor" href="#notes-on-rscabs"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Select responses maximum value should be &gt; 0 and smaller than
20??</li>
<li>for each to be tested response/endpoints,
<em>convert2score</em>
</li>
<li>for each to be tested response/endpoints, <em>prepDataRSCABS</em>,
prepare the data into matrix/table format, treatment as column,
replicate as row</li>
<li>for each to be tested response/endpoints, <em>stepKRSCABS</em>.</li>
</ol>
<pre><code>$Gon_Asynch_Dev
           Effect Treatment R.Score Statistic     P.Value Signif
1 Gon_Asynch_Dev1         5       1  2.622022 0.004370488     **
2 Gon_Asynch_Dev1         4       1       NaN 1.000000000      .
3 Gon_Asynch_Dev1         4       1       NaN 1.000000000      .
4 Gon_Asynch_Dev2         5       2  2.622022 0.004370488     **
5 Gon_Asynch_Dev2         4       2       NaN 1.000000000      .
6 Gon_Asynch_Dev2         4       2       NaN 1.000000000      .</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>combine the results into a big matrix.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">drcHelper</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: drc</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: MASS</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: drcData</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## 'drc' has been loaded.</span></span></code></pre>
<pre><code><span><span class="co">## Please cite R and 'drc' if used for a publication,</span></span></code></pre>
<pre><code><span><span class="co">## for references type 'citation()' and 'citation('drc')'.</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'drc'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     gaussian, getInitial</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare data</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in system("timedatectl", intern = TRUE): running command 'timedatectl'</span></span>
<span><span class="co">## had status 1</span></span></code></pre>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.5.1     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.3     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.0.2</span></span></code></pre>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">select()</span> masks <span style="color: #0000BB;">MASS</span>::select()</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">drcHelper</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"exampleHistData"</span><span class="op">)</span></span>
<span><span class="va">exampleHistData</span> <span class="op">&lt;-</span> <span class="va">exampleHistData</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as_tibble</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.integer</span><span class="op">)</span>,<span class="va">as.numeric</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span>
<span><span class="co">#Take the subset corresponding to F0-females of 16 weeks of age</span></span>
<span></span>
<span><span class="va">subIndex</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">exampleHistData</span><span class="op">$</span><span class="va">Generation</span><span class="op">==</span><span class="st">'F2'</span> <span class="op">&amp;</span></span>
<span>                  <span class="va">exampleHistData</span><span class="op">$</span><span class="va">Genotypic_Sex</span><span class="op">==</span><span class="st">'Female'</span> <span class="op">&amp;</span></span>
<span>                  <span class="va">exampleHistData</span><span class="op">$</span><span class="va">Age</span><span class="op">==</span><span class="st">'16_wk'</span> <span class="op">)</span></span>
<span><span class="va">exampleHistData.Sub</span><span class="op">&lt;-</span><span class="va">exampleHistData</span><span class="op">[</span><span class="va">subIndex</span>, <span class="op">]</span></span>
<span><span class="co">#Run RSCABS </span></span>
<span><span class="va">exampleResults</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/runRSCABS.html">runRSCABS</a></span><span class="op">(</span><span class="va">exampleHistData.Sub</span>,<span class="st">'Treatment'</span>,</span>
<span>                          <span class="st">'Replicate'</span>,test.type<span class="op">=</span><span class="st">'RS'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exampleResults</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">.</span>,digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="36%">
<col width="14%">
<col width="11%">
<col width="14%">
<col width="11%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">Effect</th>
<th align="right">Treatment</th>
<th align="right">R.Score</th>
<th align="right">Statistic</th>
<th align="right">P.Value</th>
<th align="left">Signif</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Gon_Incr_Oocyte_Atresia1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">1.330</td>
<td align="right">0.092</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Gon_Incr_Oocyte_Atresia1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">1.330</td>
<td align="right">0.092</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Gon_Incr_Oocyte_Atresia2</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">1.231</td>
<td align="right">0.109</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Gon_Incr_Oocyte_Atresia2</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">1.231</td>
<td align="right">0.109</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Gon_Incr_Oocyte_Atresia3</td>
<td align="right">5</td>
<td align="right">3</td>
<td align="right">1.231</td>
<td align="right">0.109</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Gon_Incr_Oocyte_Atresia3</td>
<td align="right">5</td>
<td align="right">3</td>
<td align="right">1.231</td>
<td align="right">0.109</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Gon_Incr_Oocyte_Atresia4</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">1.231</td>
<td align="right">0.109</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Gon_Incr_Oocyte_Atresia4</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">1.231</td>
<td align="right">0.109</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Gon_Proteinaceous_fluid1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">-1.410</td>
<td align="right">0.079</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Gon_Proteinaceous_fluid1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">-1.410</td>
<td align="right">0.079</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Gon_Asynch_Dev1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">2.622</td>
<td align="right">0.004</td>
<td align="left">**</td>
</tr>
<tr class="even">
<td align="left">Gon_Asynch_Dev2</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">2.622</td>
<td align="right">0.004</td>
<td align="left">**</td>
</tr>
<tr class="odd">
<td align="left">Kid_Tub_Mineralization1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">0.358</td>
<td align="right">0.360</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Kid_Tub_Mineralization1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">0.358</td>
<td align="right">0.360</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Kid_Tub_Mineralization2</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">-0.070</td>
<td align="right">0.472</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Kid_Tub_Mineralization2</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">-0.070</td>
<td align="right">0.472</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Kid_Tub_Dilation1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">-0.070</td>
<td align="right">0.472</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Kid_Tub_Dilation1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">-0.070</td>
<td align="right">0.472</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Kid_Tub_Dilation2</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">-0.049</td>
<td align="right">0.480</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Kid_Tub_Dilation2</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">-0.049</td>
<td align="right">0.480</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Kid_Tub_Regeneration1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">-1.375</td>
<td align="right">0.085</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Kid_Tub_Regeneration1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">-1.375</td>
<td align="right">0.085</td>
<td align="left">.</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">exampleHistData.Sub</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Treatment</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Gon_Asynch_Dev</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Example Data: Gon_Asynch_Dev"</span>,subtitle <span class="op">=</span> <span class="st">"subset: F2 generation, 15 week age and female"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Ordinal-Data_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># xlab&lt;-'Group'</span></span>
<span><span class="co"># ylab&lt;-'Total Fish'</span></span>
<span><span class="co"># main&lt;-'Example Graph for \n Example Data and Gon_Asynch_Dev'</span></span>
<span><span class="co"># col&lt;-c('purple1','red3')</span></span>
<span><span class="co"># Metric="Total"</span></span>
<span><span class="co"># Lowest ="Include"</span></span>
<span><span class="co"># # PlotParms&lt;-list()</span></span>
<span><span class="co"># # PlotParms$xlab&lt;-'Group'</span></span>
<span><span class="co"># # PlotParms$ylab&lt;-'Total Fish'</span></span>
<span><span class="co"># # PlotParms$main&lt;-'Example Graph for \n Example Data and Gon_Asynch_Dev'</span></span>
<span><span class="co"># # PlotParms$Colors&lt;-c('purple1','red3')</span></span>
<span><span class="co"># plotRSCABS(Data=exampleHistData.Sub, Effect="Gon_Asynch_Dev",</span></span>
<span><span class="co">#   Treatment="Treatment", Metric="Total", Lowest = "Include",</span></span>
<span><span class="co">#   #PlotParms =PlotParms,</span></span>
<span><span class="co">#   Format = NULL, File = NULL,</span></span>
<span><span class="co">#   xlab=xlab,main=main,ylab=ylab,col=col)</span></span>
<span><span class="co"># ####################</span></span>
<span><span class="co"># col &lt;- c("purple","green","black")</span></span>
<span><span class="co"># plotRSCABS(Data=exampleHistData.Sub, Effect="Gon_Incr_Oocyte_Atresia",</span></span>
<span><span class="co">#   Treatment="Treatment", Metric="Total", Lowest = "Include",</span></span>
<span><span class="co">#   #PlotParms =PlotParms, </span></span>
<span><span class="co">#   Format = NULL, File = NULL,</span></span>
<span><span class="co">#   xlab=xlab,main=main,ylab=ylab,col=col)</span></span>
<span><span class="va">cids</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">exampleHistData.Sub</span><span class="op">[</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span>,<span class="fl">2</span>,<span class="va">max</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">responses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cids</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">exampleHistData.Sub</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">+</span><span class="va">cids</span><span class="op">)</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,values_to <span class="op">=</span> <span class="st">"Response"</span>,names_to <span class="op">=</span> <span class="st">"Endpoint"</span><span class="op">)</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Treatment</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Response</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Example Histopath Data"</span>,subtitle <span class="op">=</span> <span class="st">"subset: F2 generation, 15 week age and female"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Endpoint</span><span class="op">)</span></span></code></pre></div>
<p><img src="Ordinal-Data_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'scales'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:purrr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     discard</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:readr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     col_factor</span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="va">exampleHistData.Sub</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">+</span><span class="va">cids</span><span class="op">)</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,values_to <span class="op">=</span> <span class="st">"Response"</span>,names_to <span class="op">=</span> <span class="st">"Endpoint"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Endpoint</span>,<span class="va">Treatment</span>,<span class="va">Response</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>counts<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Endpoint</span>,<span class="va">Treatment</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>total<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">counts</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Endpoint', 'Treatment'. You can override</span></span>
<span><span class="co">#&gt; using the `.groups` argument.</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat1</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Treatment</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Response</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">counts</span><span class="op">/</span><span class="va">total</span><span class="op">)</span>,stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Example Histopath Data"</span>,subtitle <span class="op">=</span> <span class="st">"subset: F2 generation, 15 week age and female"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Endpoint</span>,drop <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">percent</span><span class="op">)</span></span></code></pre></div>
<p><img src="Ordinal-Data_files/figure-html/unnamed-chunk-5-3.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DependenciesGraphs</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: visNetwork</span></span>
<span><span class="co">#&gt; Loading required package: shinydashboard</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'shinydashboard'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:graphics':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     box</span></span>
<span><span class="co">#&gt; Loading required package: XML</span></span>
<span><span class="va">dep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DependenciesGraphs/man/funDependencies.html" class="external-link">funDependencies</a></span><span class="op">(</span><span class="st">"package:drcHelper"</span>,<span class="st">"runRSCABS"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dep</span><span class="op">)</span></span></code></pre></div>
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-60761a5f9b1f4005b94d" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-60761a5f9b1f4005b94d">{"x":{"nodes":{"id":["1","2","3","4","5","6"],"label":["runRSCABS","stepDownRSCABS","stepKRSCABS","convert2Score","prepDataRSCABS","RSCABK"]},"edges":{"from":[4,5,3,6,2],"to":[1,1,1,2,3]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"edges":{"arrows":"from"},"interaction":{"dragNodes":true,"zoomSpeed":1},"physics":{"solver":"repulsion","stabilization":{"enabled":false,"iterations":5000,"onlyDynamicEdges":false}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Agresti, A. (2002) Categorical Data Analysis, Second Edition.
Hoboken, New Jersey: John Wiley &amp; Sons, Inc.</li>
<li>Harrell, F. E, (2001) Regression Modeling Strategies. New York:
Springer-Verlag.</li>
<li><a href="http://www.sthda.com/english/articles/32-r-graphics-essentials/132-plot-grouped-data-box-plot-bar-plot-and-more/" class="external-link uri">http://www.sthda.com/english/articles/32-r-graphics-essentials/132-plot-grouped-data-box-plot-bar-plot-and-more/</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="multi-quantile-jt">Multi-quantile JT<a class="anchor" aria-label="anchor" href="#multi-quantile-jt"></a>
</h2>
<p>From: John Green, personal communication.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Zhenglei Gao.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

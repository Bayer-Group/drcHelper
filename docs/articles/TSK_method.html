<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> Spearman-Karber method • drcHelper</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content=" Spearman-Karber method">
<meta property="og:description" content="drcHelper">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">drcHelper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/Tutorial_drc_Helpers.html">Example Usage of drcHelper</a>
    </li>
    <li>
      <a href="../articles/Count_Data.html">Count Data</a>
    </li>
    <li>
      <a href="../articles/EFSA-Criteria.html">EFSA Criteria</a>
    </li>
    <li>
      <a href="../articles/Example_RSCABS_PTZ.html">PTZ</a>
    </li>
    <li>
      <a href="../articles/Examples%20using%20NLS.html">Using nls to fit arbitrary dose-response models</a>
    </li>
    <li>
      <a href="../articles/Examples_MCP.html">Examples of NOEC Derivation by MCP</a>
    </li>
    <li>
      <a href="../articles/Examples_drc.html">Examples_drc</a>
    </li>
    <li>
      <a href="../articles/Examples_oecd201.html">Examples_oecd201</a>
    </li>
    <li>
      <a href="../articles/Examples_using_drda.html">Examples using drda</a>
    </li>
    <li>
      <a href="../articles/Fitting-a-biphasic-dose-reponse-model.html">Fitting a biphasic dose-reponse model</a>
    </li>
    <li>
      <a href="../articles/MQJT.html">MQJT</a>
    </li>
    <li>
      <a href="../articles/Ordinal-Data.html">An example: RSCABS for Histopath Data</a>
    </li>
    <li>
      <a href="../articles/Quantal-Data.html">Quantal Data</a>
    </li>
    <li>
      <a href="../articles/TSK_method.html"> Spearman-Karber method</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Spearman-Karber method</h1>
            
      
      
      <div class="hidden name"><code>TSK_method.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="backaground">Backaground<a class="anchor" aria-label="anchor" href="#backaground"></a>
</h2>
<p>Spearman-Karber method is still in use in regulatory Ecotox endpoints
derivation. A more common approach would be derive a EC50 from
interpolation by a smoothing line.</p>
</div>
<div class="section level2">
<h2 id="method">Method<a class="anchor" aria-label="anchor" href="#method"></a>
</h2>
<p>Two commonly used methods for calculating 50% endpoint using serial
dilutions are Spearman-Karber method and Reed and Muench method.</p>
<p>The original paper written by Kärber was published in 1931 and is in
German [Kärber, G. Archiv f. experiment. Pathol. u. Pharmakol (1931)
162: 480-483 <a href="doi:10.1007/BF01863914" class="uri">doi:10.1007/BF01863914</a>].</p>
<div class="section level3">
<h3 id="reed-and-muench-method">Reed and Muench method<a class="anchor" aria-label="anchor" href="#reed-and-muench-method"></a>
</h3>
<p>log10 50% end point dilution = log10 of dilution showing a mortality
next above 50% - (difference of logarithms × logarithm of dilution
factor).</p>
<p>Generally, the following formula is used to calculate “difference of
logarithms” (difference of logarithms is also known as “proportionate
distance” or “interpolated value”): Difference of logarithms =
[(mortality at dilution next above 50%)-50%]/[(mortality next above
50%)-(mortality next below 50%)].</p>
</div>
<div class="section level3">
<h3 id="spearman-karber-method">Spearman-Karber method<a class="anchor" aria-label="anchor" href="#spearman-karber-method"></a>
</h3>
<p>log10 50% end point dilution = <span class="math inline">\(- (x_0 -
d/2 + d \sum r_i/n_i)\)</span></p>
<p><span class="math inline">\(x_0\)</span> = log10 of the reciprocal of
the highest dilution (lowest concentration) at which all animals are
positive;</p>
<p><span class="math inline">\(d\)</span> = log10 of the dilution
factor;</p>
<p><span class="math inline">\(n_i\)</span> = number of animals used in
each individual dilution (after discounting accidental deaths);</p>
<p><span class="math inline">\(r_i\)</span> = number of positive animals
(out of <span class="math inline">\(n_i\)</span>).</p>
<p>Summation is started at dilution <span class="math inline">\(x_0\)</span>.</p>
<p>Newly proposed method Formula 1:</p>
<p>log10 50% end point dilution = -[(total number of animals died/number
of animals inoculated per dilution) + 0.5] × log dilution factor.</p>
<p>Formula 2 (if any accidental death occurred):</p>
<p>log10 50% end point dilution = -(total death score + 0.5) × log
dilution factor.</p>
</div>
</div>
<div class="section level2">
<h2 id="some-notes">Some Notes<a class="anchor" aria-label="anchor" href="#some-notes"></a>
</h2>
<p><code>tsk</code> function comes from the R package. Since it is a
single function without dependencies, it is bundled into this helper
package for the purpose of validation and verification.</p>
<p>The original goal of this R package was to replicate the results of a
DOS program that used to be provided by the EPA to perform the trimmed
Spearman-Karber method. The list “expected” contains the results of that
DOS program run on the data from Hamilton et al. Some of these are NA
because the EPA program didn’t return a result. The EPA program uses a
confidence of 2*pnorm(2)-1=0.9544997 (that is, exactly two sigmas on
both sides).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## install.packages("isotone")</span></span>
<span><span class="co">## devtools::install_github(repo="brsr/tsk")</span></span>
<span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/brsr/tsk" class="external-link">tsk</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tsk/man/tsk.html" class="external-link">tsk</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span>, <span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">17</span>, <span class="fl">20</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="co">#&gt; $use.log.doses</span></span>
<span><span class="co">#&gt; calculations done using the logs of the doses? </span></span>
<span><span class="co">#&gt;                                           TRUE </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $trim</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $was.smoothed</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $LD50</span></span>
<span><span class="co">#&gt; [1] 31.62278</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gsd</span></span>
<span><span class="co">#&gt; geometric standard deviation of LD50 estimate </span></span>
<span><span class="co">#&gt;                                      1.296928 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $conf.int</span></span>
<span><span class="co">#&gt; [1] 18.99717 52.63942</span></span>
<span><span class="co">#&gt; attr(,"conf.level")</span></span>
<span><span class="co">#&gt; [1] 0.95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "tskresult"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">hamilton</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">tolerance</span> <span class="op">=</span> <span class="fl">0.006</span></span>
<span></span>
<span><span class="va">dr1a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43.89</span>, <span class="fl">44.16</span>, <span class="fl">44.16</span>, <span class="fl">44.16</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">42.37</span>, <span class="fl">41.92</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45.47</span>, <span class="fl">46.52</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dr1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43.27</span>,   <span class="fl">44.16</span>,  <span class="fl">44.16</span>,  <span class="fl">44.16</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">41.35</span>,   <span class="fl">41.97</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45.27</span>,   <span class="fl">46.46</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dr1c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">41.73</span>, <span class="fl">42.53</span>, <span class="fl">42.79</span>, <span class="fl">42.91</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">39.14</span>, <span class="fl">39.86</span>, <span class="fl">39.51</span>, <span class="fl">40.77</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44.49</span>, <span class="fl">45.38</span>, <span class="fl">46.34</span>, <span class="fl">45.17</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dr1d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">31.36</span>, <span class="fl">31.71</span>, <span class="fl">31.71</span>, <span class="fl">31.71</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">29.74</span>, <span class="fl">31.03</span>, <span class="fl">31.08</span>, <span class="fl">31.08</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">33.07</span>, <span class="fl">32.4</span>, <span class="fl">32.35</span>, <span class="fl">32.35</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dr1e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30.8</span>, <span class="fl">31.48</span>, <span class="fl">31.48</span>, <span class="fl">31.48</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">29.6</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">32.04</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dr4a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">26.75</span>,<span class="fl">27.2</span>,<span class="fl">27.38</span>,<span class="fl">27.38</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24.28</span>,<span class="fl">24.1</span>,<span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">29.46</span>,<span class="fl">30.71</span>,<span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dr4b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19.7</span>,<span class="fl">19.52</span>,<span class="fl">19.36</span>,<span class="fl">19.07</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">17</span>,<span class="fl">16.6</span>,<span class="fl">16.22</span>,<span class="fl">15.56</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">22.84</span>,<span class="fl">22.96</span>,<span class="fl">23.09</span>,<span class="fl">23.37</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dr4c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">36.14</span>,<span class="fl">36.96</span>,<span class="fl">37.49</span>,<span class="fl">38.18</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30.09</span>,<span class="fl">30.39</span>,<span class="fl">30.69</span>,<span class="fl">29.41</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43.4</span>,<span class="fl">44.96</span>,<span class="fl">45.81</span>,<span class="fl">49.56</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dr4d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">29.55</span>,<span class="fl">29.69</span>,<span class="fl">29.79</span>,<span class="fl">29.74</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24.33</span>,<span class="fl">24.04</span>,<span class="fl">23.87</span>,<span class="fl">24</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35.88</span>,<span class="fl">36.67</span>,<span class="fl">37.18</span>,<span class="fl">36.85</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dr4e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">36.11</span>,<span class="fl">37.06</span>,<span class="fl">38.05</span>,<span class="fl">40.23</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">29.73</span>,<span class="fl">29.96</span>,<span class="fl">30.29</span>,<span class="fl">31.19</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43.85</span>,<span class="fl">45.83</span>,<span class="fl">47.8</span>,<span class="fl">51.88</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">expected</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  dr1a <span class="op">=</span> <span class="va">dr1a</span>,</span>
<span>  dr1b <span class="op">=</span> <span class="va">dr1b</span>,</span>
<span>  dr1c <span class="op">=</span> <span class="va">dr1c</span>,</span>
<span>  dr1d <span class="op">=</span> <span class="va">dr1d</span>,</span>
<span>  dr1e <span class="op">=</span> <span class="va">dr1e</span>,</span>
<span>  dr4a <span class="op">=</span> <span class="va">dr4a</span>,</span>
<span>  dr4b <span class="op">=</span> <span class="va">dr4b</span>,</span>
<span>  dr4c <span class="op">=</span> <span class="va">dr4c</span>,</span>
<span>  dr4d <span class="op">=</span> <span class="va">dr4d</span>,</span>
<span>  dr4e <span class="op">=</span> <span class="va">dr4e</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">dr</span> <span class="kw">in</span> <span class="va">expected</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">expected</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">ex</span> <span class="op">&lt;-</span> <span class="va">expected</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">dr</span> <span class="op">&lt;-</span> <span class="va">hamilton</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">dr</span><span class="op">$</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">dr</span><span class="op">$</span><span class="va">r</span><span class="op">/</span><span class="va">dr</span><span class="op">$</span><span class="va">n</span></span>
<span></span>
<span>  <span class="va">res0</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/tsk/man/tsk.html" class="external-link">tsk</a></span><span class="op">(</span><span class="va">dr</span>,  trim<span class="op">=</span><span class="fl">0</span>,conf.level<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="va">res5</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/tsk/man/tsk.html" class="external-link">tsk</a></span><span class="op">(</span><span class="va">dr</span>,  trim<span class="op">=</span><span class="fl">0.05</span>,conf.level<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="va">res10</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/tsk/man/tsk.html" class="external-link">tsk</a></span><span class="op">(</span><span class="va">dr</span>, trim<span class="op">=</span><span class="fl">0.1</span>,conf.level<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="va">res20</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/tsk/man/tsk.html" class="external-link">tsk</a></span><span class="op">(</span><span class="va">dr</span>, trim<span class="op">=</span><span class="fl">0.2</span>,conf.level<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">actual</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res0</span><span class="op">$</span><span class="va">LD50</span>,<span class="va">res5</span><span class="op">$</span><span class="va">LD50</span>,<span class="va">res10</span><span class="op">$</span><span class="va">LD50</span>,<span class="va">res20</span><span class="op">$</span><span class="va">LD50</span><span class="op">)</span>,</span>
<span>    low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res0</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">res5</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>             <span class="va">res10</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">res20</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res0</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">res5</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>             <span class="va">res10</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">res20</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ex</span> <span class="op">-</span> <span class="va">actual</span><span class="op">)</span> </span>
<span>  <span class="va">diff</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co">#ignore when the EPA result is missing</span></span>
<span>  <span class="va">mdiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">mdiff</span> <span class="op">&gt;</span> <span class="va">tolerance</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Failed test of"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">expected</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, </span>
<span>               <span class="st">", largest difference was "</span>, <span class="va">mdiff</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p><a href="https://www.cureffi.org/2015/09/20/the-math-behind-spearman-karber-analysis/" class="external-link uri">https://www.cureffi.org/2015/09/20/the-math-behind-spearman-karber-analysis/</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Zhenglei Gao.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

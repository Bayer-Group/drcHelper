<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> Spearman-Karber method • drcHelper</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content=" Spearman-Karber method">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">drcHelper</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started">
<li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/drcHelper.html">Get Started</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/Examples_drc.html">Example Helper Functions</a></li>
    <li><a class="dropdown-item" href="../articles/EFSA-Criteria.html">EFSA Criteria and Other Reliability Criteria</a></li>
    <li><a class="dropdown-item" href="../articles/Example_RSCABS.html">RSCABS</a></li>
    <li><a class="dropdown-item" href="../articles/Examples%20using%20NLS.html">NLS</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_using_drda.html">drda</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_oecd201.html">OECD 201</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/TSK_method.html">TSK method</a></li>
    <li><a class="dropdown-item" href="../articles/MQJT.html">MQJT</a></li>
    <li><a class="dropdown-item" href="../articles/Quantal-Data.html">Quantal Data</a></li>
    <li><a class="dropdown-item" href="../articles/Ordianl-Data.html">Ordinal Data</a></li>
    <li><a class="dropdown-item" href="../articles/Advanced_Fitting-a-biphasic-dose-reponse-model.html">Fitting A biphasic dose response model</a></li>
    <li><a class="dropdown-item" href="../articles/Count_Data.html">Count Data</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-validation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Validation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-validation">
<li><a class="dropdown-item" href="../articles/System_Testing.html">System Testing</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BayerGroup/drcHelper/issues/new?template=Blank+issue" aria-label="New Issue"><span class="fa fa-bug"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BayerGroup/drcHelper" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1> Spearman-Karber method</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/BayerGroup/drcHelper/blob/main/vignettes/articles/TSK_method.Rmd" class="external-link"><code>vignettes/articles/TSK_method.Rmd</code></a></small>
      <div class="d-none name"><code>TSK_method.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="backaground">Backaground<a class="anchor" aria-label="anchor" href="#backaground"></a>
</h2>
<p>Spearman-Karber method is still in use in regulatory Ecotox endpoints
derivation. A more common approach would be derive a EC50 from
interpolation by a smoothing line.</p>
</div>
<div class="section level2">
<h2 id="method">Method<a class="anchor" aria-label="anchor" href="#method"></a>
</h2>
<p>Two commonly used methods for calculating 50% endpoint using serial
dilutions are Spearman-Karber method and Reed and Muench method.</p>
<p>The original paper written by Kärber was published in 1931 and is in
German [Kärber, G. Archiv f. experiment. Pathol. u. Pharmakol (1931)
162: 480-483 <a href="doi:10.1007/BF01863914" class="uri">doi:10.1007/BF01863914</a>].</p>
<div class="section level3">
<h3 id="reed-and-muench-method">Reed and Muench method<a class="anchor" aria-label="anchor" href="#reed-and-muench-method"></a>
</h3>
<p>log10 50% end point dilution = log10 of dilution showing a mortality
next above 50% - (difference of logarithms × logarithm of dilution
factor).</p>
<p>Generally, the following formula is used to calculate “difference of
logarithms” (difference of logarithms is also known as “proportionate
distance” or “interpolated value”): Difference of logarithms =
[(mortality at dilution next above 50%)-50%]/[(mortality next above
50%)-(mortality next below 50%)].</p>
</div>
<div class="section level3">
<h3 id="spearman-karber-method">Spearman-Karber method<a class="anchor" aria-label="anchor" href="#spearman-karber-method"></a>
</h3>
<p>log10 50% end point dilution = <span class="math inline">\(- (x_0 -
d/2 + d \sum r_i/n_i)\)</span></p>
<p><span class="math inline">\(x_0\)</span> = log10 of the reciprocal of
the highest dilution (lowest concentration) at which all animals are
positive;</p>
<p><span class="math inline">\(d\)</span> = log10 of the dilution
factor;</p>
<p><span class="math inline">\(n_i\)</span> = number of animals used in
each individual dilution (after discounting accidental deaths);</p>
<p><span class="math inline">\(r_i\)</span> = number of positive animals
(out of <span class="math inline">\(n_i\)</span>).</p>
<p>Summation is started at dilution <span class="math inline">\(x_0\)</span>.</p>
<p>Newly proposed method Formula 1:</p>
<p>log10 50% end point dilution = -[(total number of animals died/number
of animals inoculated per dilution) + 0.5] × log dilution factor.</p>
<p>Formula 2 (if any accidental death occurred):</p>
<p>log10 50% end point dilution = -(total death score + 0.5) × log
dilution factor.</p>
</div>
</div>
<div class="section level2">
<h2 id="some-notes">Some Notes<a class="anchor" aria-label="anchor" href="#some-notes"></a>
</h2>
<p><code>tsk</code> function comes from the R package. Since it is a
single function without dependencies, it is bundled into this helper
package for the purpose of validation and verification.</p>
<p>The original goal of this R package was to replicate the results of a
DOS program that used to be provided by the EPA to perform the trimmed
Spearman-Karber method. The list “expected” contains the results of that
DOS program run on the data from Hamilton et al. Some of these are NA
because the EPA program didn’t return a result. The EPA program uses a
confidence of 2*pnorm(2)-1=0.9544997 (that is, exactly two sigmas on
both sides).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## install.packages("isotone")</span></span>
<span><span class="co">## devtools::install_github(repo="brsr/tsk")</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://effective-adventure-2klnejq.pages.github.io/">drcHelper</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: drc</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 'drc' has been loaded.</span></span>
<span><span class="co">#&gt; Please cite R and 'drc' if used for a publication,</span></span>
<span><span class="co">#&gt; for references type 'citation()' and 'citation('drc')'.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'drc'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     gaussian, getInitial</span></span>
<span><span class="co">## library(tsk)</span></span>
<span><span class="fu"><a href="../reference/tsk.html">tsk</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span>, <span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">17</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Trimmed Spearman-Karber method using 0 percent trim</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data was not smoothed</span></span>
<span><span class="co">#&gt; Calculation done using the logs of the doses</span></span>
<span><span class="co">#&gt; Estimated LD50: 31.62278 GSD of estimate: 1.296928</span></span>
<span><span class="co">#&gt; 95 percent confidence interval on LD50:</span></span>
<span><span class="co">#&gt;  18.99717 52.63942</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">hamilton</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="va">tolerance</span> <span class="op">&lt;-</span> <span class="fl">0.006</span></span>
<span></span>
<span><span class="va">dr1a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43.89</span>, <span class="fl">44.16</span>, <span class="fl">44.16</span>, <span class="fl">44.16</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">42.37</span>, <span class="fl">41.92</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45.47</span>, <span class="fl">46.52</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dr1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43.27</span>,   <span class="fl">44.16</span>,  <span class="fl">44.16</span>,  <span class="fl">44.16</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">41.35</span>,   <span class="fl">41.97</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45.27</span>,   <span class="fl">46.46</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dr1c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">41.73</span>, <span class="fl">42.53</span>, <span class="fl">42.79</span>, <span class="fl">42.91</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">39.14</span>, <span class="fl">39.86</span>, <span class="fl">39.51</span>, <span class="fl">40.77</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44.49</span>, <span class="fl">45.38</span>, <span class="fl">46.34</span>, <span class="fl">45.17</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dr1d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">31.36</span>, <span class="fl">31.71</span>, <span class="fl">31.71</span>, <span class="fl">31.71</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">29.74</span>, <span class="fl">31.03</span>, <span class="fl">31.08</span>, <span class="fl">31.08</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">33.07</span>, <span class="fl">32.4</span>, <span class="fl">32.35</span>, <span class="fl">32.35</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dr1e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30.8</span>, <span class="fl">31.48</span>, <span class="fl">31.48</span>, <span class="fl">31.48</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">29.6</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">32.04</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dr4a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">26.75</span>,<span class="fl">27.2</span>,<span class="fl">27.38</span>,<span class="fl">27.38</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24.28</span>,<span class="fl">24.1</span>,<span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">29.46</span>,<span class="fl">30.71</span>,<span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dr4b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19.7</span>,<span class="fl">19.52</span>,<span class="fl">19.36</span>,<span class="fl">19.07</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">17</span>,<span class="fl">16.6</span>,<span class="fl">16.22</span>,<span class="fl">15.56</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">22.84</span>,<span class="fl">22.96</span>,<span class="fl">23.09</span>,<span class="fl">23.37</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dr4c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">36.14</span>,<span class="fl">36.96</span>,<span class="fl">37.49</span>,<span class="fl">38.18</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30.09</span>,<span class="fl">30.39</span>,<span class="fl">30.69</span>,<span class="fl">29.41</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43.4</span>,<span class="fl">44.96</span>,<span class="fl">45.81</span>,<span class="fl">49.56</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dr4d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">29.55</span>,<span class="fl">29.69</span>,<span class="fl">29.79</span>,<span class="fl">29.74</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24.33</span>,<span class="fl">24.04</span>,<span class="fl">23.87</span>,<span class="fl">24</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35.88</span>,<span class="fl">36.67</span>,<span class="fl">37.18</span>,<span class="fl">36.85</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dr4e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">36.11</span>,<span class="fl">37.06</span>,<span class="fl">38.05</span>,<span class="fl">40.23</span><span class="op">)</span>,</span>
<span>  low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">29.73</span>,<span class="fl">29.96</span>,<span class="fl">30.29</span>,<span class="fl">31.19</span><span class="op">)</span>,</span>
<span>  high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">43.85</span>,<span class="fl">45.83</span>,<span class="fl">47.8</span>,<span class="fl">51.88</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">expected</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  dr1a <span class="op">=</span> <span class="va">dr1a</span>,</span>
<span>  dr1b <span class="op">=</span> <span class="va">dr1b</span>,</span>
<span>  dr1c <span class="op">=</span> <span class="va">dr1c</span>,</span>
<span>  dr1d <span class="op">=</span> <span class="va">dr1d</span>,</span>
<span>  dr1e <span class="op">=</span> <span class="va">dr1e</span>,</span>
<span>  dr4a <span class="op">=</span> <span class="va">dr4a</span>,</span>
<span>  dr4b <span class="op">=</span> <span class="va">dr4b</span>,</span>
<span>  dr4c <span class="op">=</span> <span class="va">dr4c</span>,</span>
<span>  dr4d <span class="op">=</span> <span class="va">dr4d</span>,</span>
<span>  dr4e <span class="op">=</span> <span class="va">dr4e</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">dr</span> <span class="kw">in</span> <span class="va">expected</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">expected</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">ex</span> <span class="op">&lt;-</span> <span class="va">expected</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">dr</span> <span class="op">&lt;-</span> <span class="va">hamilton</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">dr</span><span class="op">$</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">dr</span><span class="op">$</span><span class="va">r</span><span class="op">/</span><span class="va">dr</span><span class="op">$</span><span class="va">n</span></span>
<span></span>
<span>  <span class="va">res0</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/tsk.html">tsk</a></span><span class="op">(</span><span class="va">dr</span>,  trim<span class="op">=</span><span class="fl">0</span>,conf.level<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="va">res5</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/tsk.html">tsk</a></span><span class="op">(</span><span class="va">dr</span>,  trim<span class="op">=</span><span class="fl">0.05</span>,conf.level<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="va">res10</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/tsk.html">tsk</a></span><span class="op">(</span><span class="va">dr</span>, trim<span class="op">=</span><span class="fl">0.1</span>,conf.level<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="va">res20</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/tsk.html">tsk</a></span><span class="op">(</span><span class="va">dr</span>, trim<span class="op">=</span><span class="fl">0.2</span>,conf.level<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">actual</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    mid <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res0</span><span class="op">$</span><span class="va">LD50</span>,<span class="va">res5</span><span class="op">$</span><span class="va">LD50</span>,<span class="va">res10</span><span class="op">$</span><span class="va">LD50</span>,<span class="va">res20</span><span class="op">$</span><span class="va">LD50</span><span class="op">)</span>,</span>
<span>    low <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res0</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">res5</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>             <span class="va">res10</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">res20</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res0</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">res5</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>             <span class="va">res10</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">res20</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ex</span> <span class="op">-</span> <span class="va">actual</span><span class="op">)</span> </span>
<span>  <span class="va">diff</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co">#ignore when the EPA result is missing</span></span>
<span>  <span class="va">mdiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">mdiff</span> <span class="op">&gt;</span> <span class="va">tolerance</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Failed test of"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">expected</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, </span>
<span>               <span class="st">", largest difference was "</span>, <span class="va">mdiff</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p><a href="https://www.cureffi.org/2015/09/20/the-math-behind-spearman-karber-analysis/" class="external-link uri">https://www.cureffi.org/2015/09/20/the-math-behind-spearman-karber-analysis/</a></p></li>
<li><p>Hamilton, M. A.; Russo, R. C.; Thurston, R. V. Trimmed
Spearman-Karber Method for Estimating Median Lethal Concentrations in
Toxicity Bioassays. Enviro. Sci. Tech. 1977, 11 (7), 714-719. <a href="http://dx.doi.org/10.1021/es60130a004" class="external-link uri">http://dx.doi.org/10.1021/es60130a004</a></p></li>
<li><p>Ibid, 1978, 12 (4), 417. <a href="http://dx.doi.org/10.1021/es60140a017" class="external-link uri">http://dx.doi.org/10.1021/es60140a017</a></p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhenglei Gao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>

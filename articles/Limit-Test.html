<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Limit Test • drcHelper</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Limit Test">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">drcHelper</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started">
<li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/Example_Analysis_Workflow.html">Example Analysis Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/drcHelper.html">Example ECx Helper Functions Usage</a></li>
    <li><a class="dropdown-item" href="../articles/Dunnetts_Test_for_Data_with_Hierarchical_Structure.html">Example NOEC Helper Functions Usage</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_drc.html">Using DRC and BMD</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_oecd201.html">Example DRC - OECD 201</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-regulatory-stats" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Regulatory Stats</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-regulatory-stats">
<li><a class="dropdown-item" href="../articles/NOEC_Methods.html">NOEC Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/Limit-Test.html">Limit Test Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/EFSA-Criteria.html">EFSA Criteria and Other Reliability Criteria</a></li>
    <li><a class="dropdown-item" href="../articles/Example_RSCABS.html">RSCABS</a></li>
    <li><a class="dropdown-item" href="../articles/Trend-Testing.html">Trend Testing</a></li>
    <li><a class="dropdown-item" href="../articles/NOEC_ECx_BMD.html">NOEC ECx and BMD</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Quantal-Data.html">Quantal Data</a></li>
    <li><a class="dropdown-item" href="../articles/Ordinal-Data.html">Ordinal Data</a></li>
    <li><a class="dropdown-item" href="../articles/Count_Data.html">Count Data</a></li>
    <li><a class="dropdown-item" href="../articles/LMM-GLMM-and-GAMM.html">Understanding Mixed Models</a></li>
    <li><a class="dropdown-item" href="../articles/Normality-Check.html">Normality Check</a></li>
    <li><a class="dropdown-item" href="../articles/Binomial_Extra_Variance.html">Extra Binomial Variance and Trend Test</a></li>
    <li><a class="dropdown-item" href="../articles/Equivalence-Testing.html">Equivalence Testing</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>More Topics</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/Examples%20using%20NLS.html">NLS</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_using_drda.html">drda</a></li>
    <li><a class="dropdown-item" href="../articles/TSK_method.html">TSK method</a></li>
    <li><a class="dropdown-item" href="../articles/MQJT.html">MQJT</a></li>
    <li><a class="dropdown-item" href="../articles/Advanced_Fitting-a-biphasic-dose-reponse-model.html">Fitting A biphasic dose response model</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-validation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Validation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-validation">
<li><a class="dropdown-item" href="../articles/System_Testing.html">System Testing</a></li>
    <li><a class="dropdown-item" href="../articles/val_ED_plus.html">ED Calculation Consistency</a></li>
    <li><a class="dropdown-item" href="../articles/TSK-and-Probit-Models.html">TSK and Probit Model</a></li>
    <li><a class="dropdown-item" href="../articles/Verification_which_JT.html">Which JT test to use</a></li>
    <li><a class="dropdown-item" href="../articles/Test-Guidelines.html">Study Types and Templates</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayer-Group/drcHelper/issues/new?template=Blank+issue" aria-label="New Issue"><span class="fa fa-bug"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayer-Group/drcHelper" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Limit Test</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Bayer-Group/drcHelper/blob/main/vignettes/articles/Limit-Test.Rmd" class="external-link"><code>vignettes/articles/Limit-Test.Rmd</code></a></small>
      <div class="d-none name"><code>Limit-Test.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bayer-group.github.io/drcHelper/index.html">drcHelper</a></span><span class="op">)</span></span></code></pre></div>
<p>In certain situations, such as when a test chemical is anticipated to
have low toxicity or is poorly soluble, a limit test may be conducted.
This test aims to show that the No Observed Effect Concentration (NOEC)
is greater than or equal to the tested limit concentration, and that the
LD50 or EC50 is also greater than the tested limit dose, provided no
effects are observed during the study.</p>
<p>Below is an example for Limit Test analysis.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"test_cases_data"</span><span class="op">)</span></span>
<span><span class="va">testdata</span> <span class="op">&lt;-</span> <span class="va">test_cases_data</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Design</span> <span class="op">==</span><span class="st">"Limit"</span><span class="op">)</span></span>
<span><span class="va">metainfo</span> <span class="op">&lt;-</span> <span class="va">testdata</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">metainfo</span><span class="op">$</span><span class="va">Design</span><span class="op">==</span><span class="st">"Limit"</span>,<span class="st">"limit test"</span>, <span class="st">"full dose response study"</span><span class="op">)</span></span>
<span><span class="va">nconc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">Dose</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The test is a limit test for test organism Myriophyllum. There are 2
test concentrations. The interested endpoint is Growth Rate for Total
shoot length at 14 d.</p>
<div class="section level2">
<h2 id="preliminary-assessment">Preliminary Assessment<a class="anchor" aria-label="anchor" href="#preliminary-assessment"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ctr</span> <span class="op">&lt;-</span> <span class="va">testdata</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Dose</span> <span class="op">==</span> <span class="st">"0"</span><span class="op">)</span></span>
<span><span class="va">ctr0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ctr</span><span class="op">$</span><span class="va">Response</span><span class="op">)</span></span>
<span><span class="va">sres</span> <span class="op">&lt;-</span> <span class="va">testdata</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">)</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>Mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Response</span><span class="op">)</span>,SD<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">Response</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>`% Inhibition` <span class="op">=</span> <span class="op">-</span> <span class="op">(</span><span class="op">(</span><span class="va">Mean</span><span class="op">-</span><span class="va">ctr0</span><span class="op">)</span><span class="op">/</span><span class="va">ctr0</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">sres</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">.</span>,digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Dose</th>
<th align="right">Mean</th>
<th align="right">SD</th>
<th align="right">% Inhibition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="right">0.136</td>
<td align="right">0.010</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">100</td>
<td align="right">0.126</td>
<td align="right">0.005</td>
<td align="right">7.361</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="outlier-check">Outlier Check<a class="anchor" aria-label="anchor" href="#outlier-check"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dixon.test</span> <span class="op">&lt;-</span> <span class="fu">outliers</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/outliers/man/dixon.test.html" class="external-link">dixon.test</a></span></span>
<span><span class="va">DixonQ</span><span class="op">[</span><span class="va">DixonQ</span><span class="op">$</span><span class="va">n</span><span class="op">==</span><span class="fl">6</span>,<span class="st">"Q_critical"</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.56</span></span>
<span><span class="va">outRes</span> <span class="op">&lt;-</span> <span class="va">testdata</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">nest</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>normtest<span class="op">=</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">data</span>,<span class="op">~</span><span class="fu">dixon.test</span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">Response</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                       tidies<span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">normtest</span>,<span class="fu">broom</span><span class="fu">::</span><span class="va"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">outRes</span> <span class="op">&lt;-</span> <span class="va">outRes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">data</span>,<span class="va">normtest</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tidies</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">outRes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">.</span>,digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="10%">
<col width="8%">
<col width="26%">
<col width="48%">
</colgroup>
<thead><tr class="header">
<th align="left">Dose</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="left">method</th>
<th align="left">alternative</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="right">0.377</td>
<td align="right">0.423</td>
<td align="left">Dixon test for outliers</td>
<td align="left">lowest value 0.120915680098082 is an outlier</td>
</tr>
<tr class="even">
<td align="left">100</td>
<td align="right">0.342</td>
<td align="right">0.524</td>
<td align="left">Dixon test for outliers</td>
<td align="left">lowest value 0.117455425985384 is an outlier</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## by specifying the opposite: a logical indicating whether you want to check not the value with largest difference from the mean, but opposite (lowest, if most suspicious is highest etc.)</span></span>
<span><span class="va">outRes</span> <span class="op">&lt;-</span> <span class="va">testdata</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">nest</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>normtest<span class="op">=</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">data</span>,<span class="op">~</span><span class="fu">dixon.test</span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">Response</span>,opposite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                       tidies<span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">normtest</span>,<span class="fu">broom</span><span class="fu">::</span><span class="va"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">outRes</span> <span class="op">&lt;-</span> <span class="va">outRes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">data</span>,<span class="va">normtest</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tidies</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">outRes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">.</span>,digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="10%">
<col width="8%">
<col width="25%">
<col width="49%">
</colgroup>
<thead><tr class="header">
<th align="left">Dose</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="left">method</th>
<th align="left">alternative</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="right">0.146</td>
<td align="right">0.716</td>
<td align="left">Dixon test for outliers</td>
<td align="left">highest value 0.149892124046466 is an outlier</td>
</tr>
<tr class="even">
<td align="left">100</td>
<td align="right">0.048</td>
<td align="right">0.252</td>
<td align="left">Dixon test for outliers</td>
<td align="left">highest value 0.131517109035102 is an outlier</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="normality-check">Normality Check<a class="anchor" aria-label="anchor" href="#normality-check"></a>
</h2>
<p>Welch’s t-test only requires normality for each group.</p>
<p><strong>Normality for residuals</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Response</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">)</span>,data<span class="op">=</span><span class="va">testdata</span><span class="op">)</span></span>
<span><span class="va">normalres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Normality for each group</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normRes</span> <span class="op">&lt;-</span> <span class="va">testdata</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">nest</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>normtest<span class="op">=</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">data</span>,<span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">Response</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                       tidies<span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">normtest</span>,<span class="fu">broom</span><span class="fu">::</span><span class="va"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">normRes</span> <span class="op">&lt;-</span> <span class="va">normRes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">data</span>,<span class="va">normtest</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tidies</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">normRes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">.</span>,digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Dose</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="left">method</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="right">0.968</td>
<td align="right">0.880</td>
<td align="left">Shapiro-Wilk normality test</td>
</tr>
<tr class="even">
<td align="left">100</td>
<td align="right">0.892</td>
<td align="right">0.326</td>
<td align="left">Shapiro-Wilk normality test</td>
</tr>
</tbody>
</table>
<p><strong>Variance Homogeneity</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">varTest</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/leveneTest.html" class="external-link">leveneTest</a></span><span class="op">(</span><span class="va">Response</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">)</span>,data<span class="op">=</span><span class="va">testdata</span>,center<span class="op">=</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Levene's Test for Homogeneity of Variance (center = mean)</span></span>
<span><span class="co">#&gt;       Df F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; group  1  1.4879 0.2505</span></span>
<span><span class="co">#&gt;       10</span></span>
<span><span class="co">## lawstat::levene.test(testdata$Response,testdata$Dose,location="mean")</span></span>
<span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/leveneTest.html" class="external-link">leveneTest</a></span><span class="op">(</span><span class="va">Response</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">)</span>,data<span class="op">=</span><span class="va">testdata</span>,center<span class="op">=</span><span class="va">median</span><span class="op">)</span></span>
<span><span class="co">#&gt; Levene's Test for Homogeneity of Variance (center = median)</span></span>
<span><span class="co">#&gt;       Df F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; group  1  1.5126 0.2469</span></span>
<span><span class="co">#&gt;       10</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="students-t-test">Student’s t-test<a class="anchor" aria-label="anchor" href="#students-t-test"></a>
</h2>
<p><strong>two-sided</strong></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">Response</span><span class="op">~</span><span class="va">testdata</span><span class="op">$</span><span class="va">Dose</span>,var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  testdata$Response by testdata$Dose</span></span>
<span><span class="co">#&gt; t = 2.0993, df = 10, p-value = 0.06215</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means between group 0 and group 100 is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -0.0006161316  0.0207027221</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;   mean in group 0 mean in group 100 </span></span>
<span><span class="co">#&gt;         0.1364410         0.1263977</span></span>
<span><span class="va">tres</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="va">tres1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tres</span><span class="op">$</span><span class="va">estimate1</span>,<span class="va">tres</span><span class="op">$</span><span class="va">estimate2</span>, <span class="va">tres</span><span class="op">$</span><span class="va">parameter</span>,<span class="va">sres</span><span class="op">$</span><span class="va">`% Inhibition`</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="op">-</span><span class="va">tres</span><span class="op">$</span><span class="va">statistic</span>,<span class="va">tres</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tres1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mean Control"</span>, <span class="st">"Mean Test Item"</span>, <span class="st">"df"</span>, <span class="st">"%Inhibition"</span>, <span class="st">"T-statistic"</span>, <span class="st">"p-value"</span><span class="op">)</span></span>
<span><span class="va">tres1</span></span>
<span><span class="co">#&gt;   Mean Control Mean Test Item             df    %Inhibition    T-statistic </span></span>
<span><span class="co">#&gt;     0.13644102     0.12639773    10.00000000     7.36090584    -2.09934893 </span></span>
<span><span class="co">#&gt;        p-value </span></span>
<span><span class="co">#&gt;     0.06214521</span></span></code></pre></div>
<p><strong>one-sided greater</strong></p>
<p>Note that if using formula, the greater means test group is greater
than control</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">Response</span><span class="op">~</span><span class="va">testdata</span><span class="op">$</span><span class="va">Dose</span>,var.equal <span class="op">=</span> <span class="cn">TRUE</span>,alternative<span class="op">=</span><span class="st">"greater"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  testdata$Response by testdata$Dose</span></span>
<span><span class="co">#&gt; t = 2.0993, df = 10, p-value = 0.03107</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means between group 0 and group 100 is greater than 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.001372473         Inf</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;   mean in group 0 mean in group 100 </span></span>
<span><span class="co">#&gt;         0.1364410         0.1263977</span></span>
<span><span class="va">tres</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="va">tres1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tres</span><span class="op">$</span><span class="va">estimate1</span>,<span class="va">tres</span><span class="op">$</span><span class="va">estimate2</span>, <span class="va">tres</span><span class="op">$</span><span class="va">parameter</span>,<span class="va">sres</span><span class="op">$</span><span class="va">`% Inhibition`</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="op">-</span><span class="va">tres</span><span class="op">$</span><span class="va">statistic</span>,<span class="va">tres</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tres1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mean Control"</span>, <span class="st">"Mean Test Item"</span>, <span class="st">"df"</span>, <span class="st">"%Inhibition"</span>, <span class="st">"T-statistic"</span>, <span class="st">"p-value"</span><span class="op">)</span></span>
<span><span class="va">tres1</span></span>
<span><span class="co">#&gt;   Mean Control Mean Test Item             df    %Inhibition    T-statistic </span></span>
<span><span class="co">#&gt;     0.13644102     0.12639773    10.00000000     7.36090584    -2.09934893 </span></span>
<span><span class="co">#&gt;        p-value </span></span>
<span><span class="co">#&gt;     0.03107261</span></span></code></pre></div>
<p><strong>one-sided smaller</strong></p>
<p>Note that if using formula, the greater means test group is greater
than control</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">Response</span><span class="op">~</span><span class="va">testdata</span><span class="op">$</span><span class="va">Dose</span>,var.equal <span class="op">=</span> <span class="cn">TRUE</span>,alternative<span class="op">=</span><span class="st">"less"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  testdata$Response by testdata$Dose</span></span>
<span><span class="co">#&gt; t = 2.0993, df = 10, p-value = 0.9689</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means between group 0 and group 100 is less than 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;        -Inf 0.01871412</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;   mean in group 0 mean in group 100 </span></span>
<span><span class="co">#&gt;         0.1364410         0.1263977</span></span>
<span><span class="va">tres</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="va">tres1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tres</span><span class="op">$</span><span class="va">estimate1</span>,<span class="va">tres</span><span class="op">$</span><span class="va">estimate2</span>, <span class="va">tres</span><span class="op">$</span><span class="va">parameter</span>,<span class="va">sres</span><span class="op">$</span><span class="va">`% Inhibition`</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="op">-</span><span class="va">tres</span><span class="op">$</span><span class="va">statistic</span>,<span class="va">tres</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tres1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mean Control"</span>, <span class="st">"Mean Test Item"</span>, <span class="st">"df"</span>, <span class="st">"%Inhibition"</span>, <span class="st">"T-statistic"</span>, <span class="st">"p-value"</span><span class="op">)</span></span>
<span><span class="va">tres1</span></span>
<span><span class="co">#&gt;   Mean Control Mean Test Item             df    %Inhibition    T-statistic </span></span>
<span><span class="co">#&gt;      0.1364410      0.1263977     10.0000000      7.3609058     -2.0993489 </span></span>
<span><span class="co">#&gt;        p-value </span></span>
<span><span class="co">#&gt;      0.9689274</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="welchs-t-test">Welch’s t-test<a class="anchor" aria-label="anchor" href="#welchs-t-test"></a>
</h2>
<p>Welch Two Sample t-test</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">Response</span><span class="op">~</span><span class="va">testdata</span><span class="op">$</span><span class="va">Dose</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  testdata$Response by testdata$Dose</span></span>
<span><span class="co">#&gt; t = 2.0993, df = 7.5933, p-value = 0.07085</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means between group 0 and group 100 is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -0.001092339  0.021178930</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;   mean in group 0 mean in group 100 </span></span>
<span><span class="co">#&gt;         0.1364410         0.1263977</span></span>
<span><span class="va">tres</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="va">tres1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tres</span><span class="op">$</span><span class="va">estimate1</span>,<span class="va">tres</span><span class="op">$</span><span class="va">estimate2</span>, <span class="va">tres</span><span class="op">$</span><span class="va">parameter</span>,<span class="va">sres</span><span class="op">$</span><span class="va">`% Inhibition`</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="op">-</span><span class="va">tres</span><span class="op">$</span><span class="va">statistic</span>,<span class="va">tres</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tres1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mean Control"</span>, <span class="st">"Mean Test Item"</span>, <span class="st">"df"</span>, <span class="st">"%Inhibition"</span>, <span class="st">"T-statistic"</span>, <span class="st">"p-value"</span><span class="op">)</span></span>
<span><span class="va">tres1</span></span>
<span><span class="co">#&gt;   Mean Control Mean Test Item             df    %Inhibition    T-statistic </span></span>
<span><span class="co">#&gt;     0.13644102     0.12639773     7.59330452     7.36090584    -2.09934893 </span></span>
<span><span class="co">#&gt;        p-value </span></span>
<span><span class="co">#&gt;     0.07085487</span></span></code></pre></div>
<p><strong>one-sided greagter </strong></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">Response</span><span class="op">~</span><span class="va">testdata</span><span class="op">$</span><span class="va">Dose</span>,alternative <span class="op">=</span><span class="st">"less"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  testdata$Response by testdata$Dose</span></span>
<span><span class="co">#&gt; t = 2.0993, df = 7.5933, p-value = 0.9646</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means between group 0 and group 100 is less than 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;        -Inf 0.01900155</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;   mean in group 0 mean in group 100 </span></span>
<span><span class="co">#&gt;         0.1364410         0.1263977</span></span>
<span><span class="va">tres</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="va">tres1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tres</span><span class="op">$</span><span class="va">estimate1</span>,<span class="va">tres</span><span class="op">$</span><span class="va">estimate2</span>, <span class="va">tres</span><span class="op">$</span><span class="va">parameter</span>,<span class="va">sres</span><span class="op">$</span><span class="va">`% Inhibition`</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="op">-</span><span class="va">tres</span><span class="op">$</span><span class="va">statistic</span>,<span class="va">tres</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tres1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mean Control"</span>, <span class="st">"Mean Test Item"</span>, <span class="st">"df"</span>, <span class="st">"%Inhibition"</span>, <span class="st">"T-statistic"</span>, <span class="st">"p-value"</span><span class="op">)</span></span>
<span><span class="va">tres1</span></span>
<span><span class="co">#&gt;   Mean Control Mean Test Item             df    %Inhibition    T-statistic </span></span>
<span><span class="co">#&gt;      0.1364410      0.1263977      7.5933045      7.3609058     -2.0993489 </span></span>
<span><span class="co">#&gt;        p-value </span></span>
<span><span class="co">#&gt;      0.9645726</span></span></code></pre></div>
<p><strong>one-sided smaller </strong></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">$</span><span class="va">Response</span><span class="op">~</span><span class="va">testdata</span><span class="op">$</span><span class="va">Dose</span>,alternative <span class="op">=</span><span class="st">"greater"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  testdata$Response by testdata$Dose</span></span>
<span><span class="co">#&gt; t = 2.0993, df = 7.5933, p-value = 0.03543</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means between group 0 and group 100 is greater than 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.001085044         Inf</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;   mean in group 0 mean in group 100 </span></span>
<span><span class="co">#&gt;         0.1364410         0.1263977</span></span>
<span><span class="va">tres</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="va">tres1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">tres</span><span class="op">$</span><span class="va">estimate1</span>,<span class="va">tres</span><span class="op">$</span><span class="va">estimate2</span>, <span class="va">tres</span><span class="op">$</span><span class="va">parameter</span>,<span class="va">sres</span><span class="op">$</span><span class="va">`% Inhibition`</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="op">-</span><span class="va">tres</span><span class="op">$</span><span class="va">statistic</span>,<span class="va">tres</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tres1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mean Control"</span>, <span class="st">"Mean Test Item"</span>, <span class="st">"df"</span>, <span class="st">"%Inhibition"</span>, <span class="st">"T-statistic"</span>, <span class="st">"p-value"</span><span class="op">)</span></span>
<span><span class="va">tres1</span></span>
<span><span class="co">#&gt;   Mean Control Mean Test Item             df    %Inhibition    T-statistic </span></span>
<span><span class="co">#&gt;     0.13644102     0.12639773     7.59330452     7.36090584    -2.09934893 </span></span>
<span><span class="co">#&gt;        p-value </span></span>
<span><span class="co">#&gt;     0.03542743</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="nonparametric-test">Nonparametric test<a class="anchor" aria-label="anchor" href="#nonparametric-test"></a>
</h2>
<div class="section level3">
<h3 id="kruskalwallis-test">Kruskal–Wallis test<a class="anchor" aria-label="anchor" href="#kruskalwallis-test"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">kwres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test</a></span><span class="op">(</span><span class="va">Response</span><span class="op">~</span><span class="va">Dose</span>,data<span class="op">=</span><span class="va">testdata</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Kruskal-Wallis rank sum test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  Response by Dose</span></span>
<span><span class="co">#&gt; Kruskal-Wallis chi-squared = 4.3333, df = 1, p-value = 0.03737</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dunns-test-many-to-one">Dunn’s test (many-to-one)<a class="anchor" aria-label="anchor" href="#dunns-test-many-to-one"></a>
</h3>
<p>In essence, Dunn’s test can be viewed as a series of Wilcoxon rank
sum tests applied to pairs of groups, with adjustments made for multiple
comparisons.</p>
<p>The link between Dunn’s test and the Wilcoxon rank sum test lies in
their non-parametric nature and rank-based approach. While the Wilcoxon
rank sum test is used for comparing two groups, Dunn’s test extends the
concept of rank comparisons to multiple groups following the
Kruskal-Wallis test.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## (dunnres &lt;- PMCMRplus::kwManyOneDunnTest(Response~factor(Dose),data=testdata))</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="wilcoxon-test">Wilcoxon test<a class="anchor" aria-label="anchor" href="#wilcoxon-test"></a>
</h3>
<p>Wilcoxon rank-sum test (also called Mann–Whitney U-test) when the
data deviates significantly from normal.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">Ures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span><span class="va">Response</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">)</span>,data<span class="op">=</span><span class="va">testdata</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Wilcoxon rank sum exact test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  Response by factor(Dose)</span></span>
<span><span class="co">#&gt; W = 31, p-value = 0.04113</span></span>
<span><span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span></span>
<span><span class="co">## same results would be obtained by specifying x and y instead of a formula</span></span>
<span><span class="co">## wilcox.test(testdata$Response[testdata$Dose=="0"],testdata$Response[testdata$Dose=="100"],data=testdata)</span></span>
<span><span class="op">(</span><span class="va">Ures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span><span class="va">Response</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">)</span>,data<span class="op">=</span><span class="va">testdata</span>,alternative<span class="op">=</span><span class="st">"greater"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Wilcoxon rank sum exact test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  Response by factor(Dose)</span></span>
<span><span class="co">#&gt; W = 31, p-value = 0.02056</span></span>
<span><span class="co">#&gt; alternative hypothesis: true location shift is greater than 0</span></span>
<span><span class="op">(</span><span class="va">Ures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span><span class="va">Response</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">)</span>,data<span class="op">=</span><span class="va">testdata</span>,alternative<span class="op">=</span><span class="st">"less"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Wilcoxon rank sum exact test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  Response by factor(Dose)</span></span>
<span><span class="co">#&gt; W = 31, p-value = 0.987</span></span>
<span><span class="co">#&gt; alternative hypothesis: true location shift is less than 0</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhenglei Gao, Sean Ryan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>

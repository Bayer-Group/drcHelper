<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Count Data in General â€¢ drcHelper</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Count Data in General">
<meta name="description" content="Methods for dose-response with count data
">
<meta property="og:description" content="Methods for dose-response with count data
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">drcHelper</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started">
<li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/drcHelper.html">Example ECx Helper Functions Usage</a></li>
    <li><a class="dropdown-item" href="../articles/Dunnetts_Test_for_Data_with_Hierarchical_Structure.html">Example NOEC Helper Functions Usage</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_drc.html">Using DRC and BMD</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_oecd201.html">Example DRC - OECD 201</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-regulatory-stats" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Regulatory Stats</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-regulatory-stats">
<li><a class="dropdown-item" href="../articles/NOEC_Methods.html">NOEC Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/Limit-Test.html">Limit Test Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/EFSA-Criteria.html">EFSA Criteria and Other Reliability Criteria</a></li>
    <li><a class="dropdown-item" href="../articles/Example_RSCABS.html">RSCABS</a></li>
    <li><a class="dropdown-item" href="../articles/Trend-Testing.html">Trend Testing</a></li>
    <li><a class="dropdown-item" href="../articles/NOEC_ECx_BMD.html">NOEC ECx and BMD</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/core_statistical_methods.html">Core Statistical Methods Overview</a></li>
    <li><a class="dropdown-item" href="../articles/Quantal-Data.html">Quantal Data Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Ordinal-Data.html">Ordinal Data Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Count_Data.html">Count Data Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/LMM-GLMM-and-GAMM.html">LMM, GLMM, and GAMM Models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/advanced_topics.html">Advanced Topics Overview</a></li>
    <li><a class="dropdown-item" href="../articles/Normality-Check.html">Normality Checks</a></li>
    <li><a class="dropdown-item" href="../articles/Binomial_Extra_Variance.html">Binomial Extra Variance</a></li>
    <li><a class="dropdown-item" href="../articles/Equivalence-Testing.html">Equivalence Testing</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/alternative_methods.html">Alternative Methods Overview</a></li>
    <li><a class="dropdown-item" href="../articles/Examples%20using%20NLS.html">NLS Examples</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_using_drda.html">DRDA Examples</a></li>
    <li><a class="dropdown-item" href="../articles/TSK_method.html">TSK Method</a></li>
    <li><a class="dropdown-item" href="../articles/MQJT.html">MQJT</a></li>
    <li><a class="dropdown-item" href="../articles/Advanced_Fitting-a-biphasic-dose-reponse-model.html">Biphasic Dose Response Models</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-validation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Validation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-validation">
<li><a class="dropdown-item" href="../articles/System_Testing.html">System Testing</a></li>
    <li><a class="dropdown-item" href="../articles/val_ED_plus.html">ED Calculation Consistency</a></li>
    <li><a class="dropdown-item" href="../articles/TSK-and-Probit-Models.html">TSK and Probit Model</a></li>
    <li><a class="dropdown-item" href="../articles/Verification_which_JT.html">Which JT test to use</a></li>
    <li><a class="dropdown-item" href="../articles/Verification_CA_test.html">Verification of CA test</a></li>
    <li><a class="dropdown-item" href="../articles/Validation_MCP_tests.html">Validation of MCP tests</a></li>
    <li><a class="dropdown-item" href="../articles/Test-Guidelines.html">Study Types and Templates</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayer-Group/drcHelper/issues/new?template=Blank+issue" aria-label="New Issue"><span class="fa fa-bug"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayer-Group/drcHelper" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Count Data in General</h1>
                        <h4 data-toc-skip class="author">Zhenglei
Gao</h4>
            
            <h4 data-toc-skip class="date">December 4, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Bayer-Group/drcHelper/blob/main/vignettes/articles/Count_Data.Rmd" class="external-link"><code>vignettes/articles/Count_Data.Rmd</code></a></small>
      <div class="d-none name"><code>Count_Data.Rmd</code></div>
    </div>

    
    
<p><em>To be written. Contribution is welcome.</em></p>
<div class="section level2">
<h2 id="testing-approaches">Testing Approaches<a class="anchor" aria-label="anchor" href="#testing-approaches"></a>
</h2>
<p>Usually for count data, we treat them as continuous and sometimes do
transformations so that the variance is stabilized across the treatment
groups to derive an NOEC. Transformation of data need also careful
interpretation of the effect size estimation and the corresponding
confidence intervals. There is also a relatively new approach proposed
called CPCAT. Its application domain is however limited as it is only
valid for strictly Poisson data, which is not validated or used in this
package.</p>
<div class="section level3">
<h3 id="poisson-or-non-poisson">Poisson or Non-Poisson?<a class="anchor" aria-label="anchor" href="#poisson-or-non-poisson"></a>
</h3>
<p>To understand this, we have to think about what is a Poisson
distribution and what this distribution describes. It actually emerges
from the basic properties of the natural counting process. For example,
when you count the number of customers arriving at a store, the number
of defects in manufacturing, the number of rare events in a fixed time
period, the number of occurrences in a fixed spatial area. The
assumptions behind these counting processes are:</p>
<ul>
<li>Events occur independently.</li>
<li>Events occur at a constant average rate</li>
<li>Events cannot occur exactly simultaneously</li>
<li>The probability of an event is proportional to the time
interval</li>
</ul>
<p>The key parameter for Poisson distribution is the mean, which is
actually the rate parameter <span class="math inline">\(\lambda\)</span>. Poisson distribution also has
this particular mean-variance relationship, as in many real-world
counting processes, the variability (variance) increases with the
average count (mean). The Poisson distribution naturally captures this
through its unique property where the mean equals the variance. However,
when the assumptions of independence or constant rate are violated, or
when thereâ€™s overdispersion (variance exceeding the mean), other
distributions like the Negative Binomial might be more appropriate.</p>
<p>Actually, I would say that Poisson distribution is very often not the
most appropriate choice for modeling pitfall trap counts or soil core
counts of soil organisms. Hereâ€™s why:</p>
<ol style="list-style-type: decimal">
<li>Violation of Independence:</li>
</ol>
<ul>
<li>Soil organisms typically show aggregated distributions</li>
<li>Individuals are not randomly distributed but cluster in favorable
microhabitats</li>
<li>Social behavior and environmental preferences lead to spatial
clustering</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Non-constant Rate:</li>
</ol>
<ul>
<li>Abundance vary with environmental conditions</li>
<li>Seasonal and daily patterns affect capture or sampling
probability</li>
<li>Spatial heterogeneity in habitat quality influences
distribution</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Overdispersion and underdispersion</li>
</ol>
<ul>
<li>Variance in counts typically exceeds the mean. (under-dispersion
could also occur by chance or lots of zeros or small numbers for certain
species)</li>
<li>Clustering behavior leads to more extreme counts than expected under
Poisson</li>
<li>Environmental heterogeneity increases variability</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Heterogeneous variance across treatment groups.</li>
</ol>
<ul>
<li>Often the approaches assuming Poisson, like CPCAT, also starting
from a common mean with a common variance in the null distribution,
neither of them could be true in reality.</li>
</ul>
<p>More appropriate approaches for modelling might be Negative Binomial
distribution (handles overdispersion), zero-inflated models (if many
zero counts), mixed models (to account for spatial and temporal
dependencies), spatial point process models (to explicitly account for
spatial patterns). When the primary goal is determining a NOEC (No
Observed Effect Concentration), simpler approaches often prove
sufficient. Traditional methods, such as treating counts as continuous
data with normal distribution assumptions, appropriate variance
structure considerations, and suitable data transformations can provide
robust and reliable conclusions. While more complex models might offer
additional insights, they may not necessarily improve the practical
utility of the analysis, particularly for regulatory purposes where
transparency and reproducibility are crucial.</p>
</div>
</div>
<div class="section level2">
<h2 id="additional-notes">Additional Notes<a class="anchor" aria-label="anchor" href="#additional-notes"></a>
</h2>
<p>As an example, a Poisson distribution with rate of 100 in time window
1, a count of 137 is very unlikely coming from this distribution but 120
could possibly be occuring with 95% confidence level. On the other hand,
it would be rare to oberve 120 from a normal distribution with 100 mean
and sd 10. Similarly for small numbers, like a mean of 4 and sd of 2, 8
is more likely to be observed from a Poisson but not from a normal
distribution.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">###  Fisher's Exact Test for Count Data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/poisson.test.html" class="external-link">poisson.test</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">1</span>,r<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Exact Poisson test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  120 time base: 1</span></span>
<span><span class="co">#&gt; number of events = 120, time base = 1, p-value = 0.05088</span></span>
<span><span class="co">#&gt; alternative hypothesis: true event rate is not equal to 100</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;   99.49193 143.49059</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; event rate </span></span>
<span><span class="co">#&gt;        120</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fl">120</span>,mean<span class="op">=</span><span class="fl">100</span>,sd<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9772499</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/poisson.test.html" class="external-link">poisson.test</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">1</span>,r<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Exact Poisson test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  8 time base: 1</span></span>
<span><span class="co">#&gt; number of events = 8, time base = 1, p-value = 0.06945</span></span>
<span><span class="co">#&gt; alternative hypothesis: true event rate is not equal to 4</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;   3.453832 15.763189</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; event rate </span></span>
<span><span class="co">#&gt;          8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fl">8</span>,mean<span class="op">=</span><span class="fl">4</span>,sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9772499</span></span></code></pre></div>
<div class="section level3">
<h3 id="data-transformation">Data Transformation<a class="anchor" aria-label="anchor" href="#data-transformation"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="modelling-approaches">Modelling Approaches<a class="anchor" aria-label="anchor" href="#modelling-approaches"></a>
</h2>
</div>
<div class="section level2">
<h2 id="poisson-quasi-poisson-negative-binomial">Poisson, Quasi-Poisson, Negative-Binomial<a class="anchor" aria-label="anchor" href="#poisson-quasi-poisson-negative-binomial"></a>
</h2>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><a href="https://www.semanticscholar.org/paper/Quasi-Poisson-vs.-negative-binomial-regression%3A-how-Hoef-Boveng/01d13ec2187a90742ebcf288437e3d0a1ca28dd8" class="external-link">Quasi-Poisson
vs.Â negative binomial regression: how should we model overdispersed
count data?</a></li>
<li><a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC10184615/" class="external-link">Revisiting the
analysis pipeline for overdispersed Poisson and binomial data</a></li>
<li><a href="https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#testing-for-overdispersioncomputing-overdispersion-factor" class="external-link">Check
for over-dispersion</a></li>
<li><a href="https://stats.stackexchange.com/questions/201903/how-to-deal-with-overdispersion-in-poisson-regression-quasi-likelihood-negativ/332250#332250" class="external-link">Stackoverflow
post on overdispersion in Poisson</a></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhenglei Gao, Sean Ryan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>

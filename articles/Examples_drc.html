<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Examples of using drc and bmd • drcHelper</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Examples of using drc and bmd">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">drcHelper</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started">
<li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/Example_Analysis_Workflow.html">Example Analysis Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/drcHelper.html">Example ECx Helper Functions Usage</a></li>
    <li><a class="dropdown-item" href="../articles/Dunnetts_Test_for_Data_with_Hierarchical_Structure.html">Example NOEC Helper Functions Usage</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_drc.html">Using DRC and BMD</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_oecd201.html">Example DRC - OECD 201</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-regulatory-stats" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Regulatory Stats</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-regulatory-stats">
<li><a class="dropdown-item" href="../articles/NOEC_Methods.html">NOEC Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/Limit-Test.html">Limit Test Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/EFSA-Criteria.html">EFSA Criteria and Other Reliability Criteria</a></li>
    <li><a class="dropdown-item" href="../articles/Example_RSCABS.html">RSCABS</a></li>
    <li><a class="dropdown-item" href="../articles/Trend-Testing.html">Trend Testing</a></li>
    <li><a class="dropdown-item" href="../articles/NOEC_ECx_BMD.html">NOEC ECx and BMD</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Quantal-Data.html">Quantal Data</a></li>
    <li><a class="dropdown-item" href="../articles/Ordinal-Data.html">Ordinal Data</a></li>
    <li><a class="dropdown-item" href="../articles/Count_Data.html">Count Data</a></li>
    <li><a class="dropdown-item" href="../articles/LMM-GLMM-and-GAMM.html">Understanding Mixed Models</a></li>
    <li><a class="dropdown-item" href="../articles/Normality-Check.html">Normality Check</a></li>
    <li><a class="dropdown-item" href="../articles/Binomial_Extra_Variance.html">Extra Binomial Variance and Trend Test</a></li>
    <li><a class="dropdown-item" href="../articles/Equivalence-Testing.html">Equivalence Testing</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>More Topics</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/Examples%20using%20NLS.html">NLS</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_using_drda.html">drda</a></li>
    <li><a class="dropdown-item" href="../articles/TSK_method.html">TSK method</a></li>
    <li><a class="dropdown-item" href="../articles/MQJT.html">MQJT</a></li>
    <li><a class="dropdown-item" href="../articles/Advanced_Fitting-a-biphasic-dose-reponse-model.html">Fitting A biphasic dose response model</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-validation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Validation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-validation">
<li><a class="dropdown-item" href="../articles/System_Testing.html">System Testing</a></li>
    <li><a class="dropdown-item" href="../articles/val_ED_plus.html">ED Calculation Consistency</a></li>
    <li><a class="dropdown-item" href="../articles/TSK-and-Probit-Models.html">TSK and Probit Model</a></li>
    <li><a class="dropdown-item" href="../articles/Verification_which_JT.html">Which JT test to use</a></li>
    <li><a class="dropdown-item" href="../articles/Test-Guidelines.html">Study Types and Templates</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayer-Group/drcHelper/issues/new?template=Blank+issue" aria-label="New Issue"><span class="fa fa-bug"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayer-Group/drcHelper" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Examples of using drc and bmd</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Bayer-Group/drcHelper/blob/main/vignettes/articles/Examples_drc.Rmd" class="external-link"><code>vignettes/articles/Examples_drc.Rmd</code></a></small>
      <div class="d-none name"><code>Examples_drc.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bayer-group.github.io/drcHelper/index.html">drcHelper</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: drc</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span>
<span><span class="co">#&gt; Loading required package: drcData</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 'drc' has been loaded.</span></span>
<span><span class="co">#&gt; Please cite R and 'drc' if used for a publication,</span></span>
<span><span class="co">#&gt; for references type 'citation()' and 'citation('drc')'.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'drc'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     gaussian, getInitial</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.r-project.org" class="external-link">drc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr" class="external-link">plyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="is-there-a-difference-between-ecx-and-bmd">Is there a difference between ECx and BMD?<a class="anchor" aria-label="anchor" href="#is-there-a-difference-between-ecx-and-bmd"></a>
</h2>
<p>BMD (Benchmark Dose) and ECx (Effect Concentration x) are both
important concepts in the fields of toxicology and ecotoxicology,
respectively. While they originate from different domains and have
distinct definitions and applications, they share similarities in their
purpose—specifying a dose or concentration that elicits a specific
effect relative to a control or background level.</p>
<p>ECx (Effect Concentration x) is commonly used in ecotoxicology. ECx
represents the concentration of a substance that causes a specified
effect on a certain percentage of the test population (e.g., 10%, 50%,
or 90%) or causes a x% reduction / inhibition / stimulation in average
compared to control.</p>
<p>BMD (Benchmark Dose) is primarily used in toxicology. It refers to a
dose of a substance that produces a predefined change in response
compared to a control group. The flexibility in defining BMD allows for
tailored assessments based on the specific toxicological thresholds and
regulatory requirements. For example, in bmd package, “excess”,
“additional” and “point” are provide for binomial response. “relative”,
“extra”, “added”, “excess hybrid”, “additional hybrid”, and “point” are
for continuous response. “relative”, “extra”, and “point” are for count
response data.</p>
<p>In ecotoxicology area, the two concepts are essentially the same,
however, in terms of tools, the calculations use different default model
suites, parameterizations, evaluation criteria, and even methodology
framework.</p>
<ul>
<li>Crump, K. (2002) Critical Issues in Benchmark Calculations from
Continuous Data, Critical Reviews in Toxicology 32, 133–153.</li>
</ul>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<ul>
<li>From the help page of <code><a href="https://rdrr.io/pkg/drc/man/ED.drc.html" class="external-link">drc::ED</a></code>
</li>
</ul>
<blockquote>
<p>There are several options for calculating confidence intervals
through the argument interval. The option “delta” results in
asymptotical Wald-type confidence intervals (using the delta method and
the normal or t-distribution depending on the type of response). The
option “fls” produces (possibly skewed) confidence intervals through
back-transformation from the logarithm scale (only meaningful in case
the parameter in the model is log(ED50) as for the llogistic2) models.
The option “tfls” is for transforming back and forth from log scale
(experimental). The option “inv” results in confidence intervals
obtained through inverse regression.</p>
</blockquote>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Model with ED50 as a parameter</span></span>
<span><span class="va">finney71.m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/drm.html" class="external-link">drm</a></span><span class="op">(</span><span class="va">affected</span> <span class="op">/</span> <span class="va">total</span> <span class="op">~</span> <span class="va">dose</span>, weights <span class="op">=</span> <span class="va">total</span>,</span>
<span>data <span class="op">=</span> <span class="va">finney71</span>, fct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/LL.2.html" class="external-link">LL.2</a></span><span class="op">(</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">finney71.m1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model fitted: Log-logistic (ED50 as parameter) with lower limit at 0 and upper limit at 1 (2 parms)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               Estimate Std. Error t-value   p-value    </span></span>
<span><span class="co">#&gt; b:(Intercept) -3.10363    0.38773 -8.0047 1.154e-15 ***</span></span>
<span><span class="co">#&gt; e:(Intercept)  4.82890    0.24958 19.3485 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">finney71.m1</span>, broken <span class="op">=</span> <span class="cn">TRUE</span>, bp <span class="op">=</span> <span class="fl">0.1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Examples_drc_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/ED.drc.html" class="external-link">ED</a></span><span class="op">(</span><span class="va">finney71.m1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">50</span><span class="op">)</span>, interval <span class="op">=</span> <span class="st">"delta"</span>, reference <span class="op">=</span> <span class="st">"control"</span>,type<span class="op">=</span><span class="st">"relative"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated effective doses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Estimate Std. Error   Lower   Upper</span></span>
<span><span class="co">#&gt; e:1:10  2.37896    0.25164 1.88576 2.87217</span></span>
<span><span class="co">#&gt; e:1:20  3.08932    0.24372 2.61163 3.56700</span></span>
<span><span class="co">#&gt; e:1:50  4.82890    0.24958 4.33974 5.31806</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/ED.drc.html" class="external-link">ED</a></span><span class="op">(</span><span class="va">finney71.m1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.10</span>, <span class="fl">0.20</span>, <span class="fl">0.50</span><span class="op">)</span>, interval <span class="op">=</span> <span class="st">"delta"</span>, reference <span class="op">=</span> <span class="st">"control"</span>,type<span class="op">=</span><span class="st">"absolute"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated effective doses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Estimate Std. Error   Lower   Upper</span></span>
<span><span class="co">#&gt; e:1:0.1  2.37896    0.25164 1.88576 2.87217</span></span>
<span><span class="co">#&gt; e:1:0.2  3.08932    0.24372 2.61163 3.56700</span></span>
<span><span class="co">#&gt; e:1:0.5  4.82890    0.24958 4.33974 5.31806</span></span>
<span><span class="co">##  Referecen could be the upper limit or the control. In this case I am not sure what has been calcuated.</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/ED.drc.html" class="external-link">ED</a></span><span class="op">(</span><span class="va">finney71.m1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">50</span><span class="op">)</span>, interval <span class="op">=</span> <span class="st">"delta"</span>, reference <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated effective doses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Estimate Std. Error    Lower    Upper</span></span>
<span><span class="co">#&gt; e:1:10  9.80184    0.97020  7.90028 11.70341</span></span>
<span><span class="co">#&gt; e:1:20  7.54803    0.55188  6.46636  8.62969</span></span>
<span><span class="co">#&gt; e:1:50  4.82890    0.24958  4.33974  5.31806</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/ED.drc.html" class="external-link">ED</a></span><span class="op">(</span><span class="va">finney71.m1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">50</span><span class="op">)</span>, interval <span class="op">=</span> <span class="st">"delta"</span>, reference <span class="op">=</span> <span class="st">"control"</span>,type<span class="op">=</span><span class="st">"relative"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated effective doses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Estimate Std. Error   Lower   Upper</span></span>
<span><span class="co">#&gt; e:1:10  2.37896    0.25164 1.88576 2.87217</span></span>
<span><span class="co">#&gt; e:1:20  3.08932    0.24372 2.61163 3.56700</span></span>
<span><span class="co">#&gt; e:1:50  4.82890    0.24958 4.33974 5.31806</span></span>
<span></span>
<span><span class="fu">bmd</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bmd/man/bmd.html" class="external-link">bmd</a></span><span class="op">(</span><span class="va">finney71.m1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>,backgType<span class="op">=</span><span class="st">"modelBased"</span>,def<span class="op">=</span><span class="st">"excess"</span>,interval<span class="op">=</span><span class="st">"inv"</span><span class="op">)</span></span>
<span><span class="co">#&gt;       BMD     BMDL</span></span>
<span><span class="co">#&gt;  2.378965 2.020913</span></span>
<span></span>
<span><span class="co">## Note that in ED.plus, instead of using interval = "delta", we specifify CI = "delta", to distinguish the option to calculate CI</span></span>
<span><span class="fu">drcHelper</span><span class="fu">::</span><span class="fu"><a href="../reference/ED.plus.html">ED.plus</a></span><span class="op">(</span><span class="va">finney71.m1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">50</span><span class="op">)</span>, CI <span class="op">=</span> <span class="st">"inv"</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Estimate Std. Error    Lower    Upper</span></span>
<span><span class="co">#&gt; EC 10 2.378965  0.2516419 1.965051 2.792879</span></span>
<span><span class="co">#&gt; EC 20 3.089316  0.2437215 2.688430 3.490202</span></span>
<span><span class="co">#&gt; EC 50 4.828897  0.2495753 4.418382 5.239411</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Fitting 4-parameter log-logistic model</span></span>
<span><span class="va">ryegrass.m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/drm.html" class="external-link">drm</a></span><span class="op">(</span><span class="va">ryegrass</span>, fct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/LL.4.html" class="external-link">LL.4</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Calculating EC/ED values</span></span>
<span><span class="co">## Also displaying 95% confidence intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/ED.drc.html" class="external-link">ED</a></span><span class="op">(</span><span class="va">ryegrass.m1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">90</span><span class="op">)</span>, interval <span class="op">=</span> <span class="st">"delta"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated effective doses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Estimate Std. Error   Lower   Upper</span></span>
<span><span class="co">#&gt; e:1:10  1.46371    0.18677 1.07411 1.85330</span></span>
<span><span class="co">#&gt; e:1:50  3.05795    0.18573 2.67053 3.44538</span></span>
<span><span class="co">#&gt; e:1:90  6.38864    0.84510 4.62580 8.15148</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ryegrass.m1</span>,broken <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ryegrass.m1</span>, broken <span class="op">=</span> <span class="cn">TRUE</span>, type<span class="op">=</span><span class="st">"confidence"</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Examples_drc_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Fitting the Brain-Cousens model</span></span>
<span><span class="va">lettuce.m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/drm.html" class="external-link">drm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">conc</span>,</span>
<span>data <span class="op">=</span> <span class="va">lettuce</span>, fct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/BC.html" class="external-link">BC.4</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lettuce.m1</span>,confidence.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
<p><img src="Examples_drc_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Calculating ED[-10]</span></span>
<span></span>
<span><span class="co"># This does not work</span></span>
<span><span class="co">#ED(lettuce.m1, -10)</span></span>
<span></span>
<span><span class="co">## Now it does work</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/drc/man/ED.drc.html" class="external-link">ED</a></span><span class="op">(</span><span class="va">lettuce.m1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>,<span class="op">-</span><span class="fl">20</span><span class="op">)</span>, bound <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  <span class="co"># works</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated effective doses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Estimate Std. Error</span></span>
<span><span class="co">#&gt; e:1:-10  1.86458    1.01634</span></span>
<span><span class="co">#&gt; e:1:-20  0.96333    1.23014</span></span>
<span></span>
<span><span class="co">### Using a different break point.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lettuce.m1</span>, main <span class="op">=</span> <span class="st">"bp = default"</span><span class="op">)</span>  <span class="co"># using the default</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lettuce.m1</span>, bp <span class="op">=</span> <span class="fl">1e-4</span>, main <span class="op">=</span> <span class="st">"bp = 1e-4"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lettuce.m1</span>, bp <span class="op">=</span> <span class="fl">1e-6</span>, main <span class="op">=</span> <span class="st">"bp = 1e-6"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lettuce.m1</span>, bp <span class="op">=</span> <span class="fl">1e-8</span>, main <span class="op">=</span> <span class="st">"bp = 1e-8"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Fitting model to be plotted below</span></span>
<span><span class="va">spinach.m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/drm.html" class="external-link">drm</a></span><span class="op">(</span><span class="va">SLOPE</span> <span class="op">~</span> <span class="va">DOSE</span>, <span class="va">CURVE</span>, data <span class="op">=</span> <span class="va">spinach</span>, fct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/drc/man/LL.4.html" class="external-link">LL.4</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plot with no colours</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spinach.m1</span>, main <span class="op">=</span> <span class="st">"Different line types (default)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Examples_drc_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## Plot with default colours</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spinach.m1</span>, col <span class="op">=</span> <span class="cn">TRUE</span>, main <span class="op">=</span> <span class="st">"Default colours"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Examples_drc_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## Plot with specified colours</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spinach.m1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">3</span>,<span class="fl">23</span>,<span class="fl">56</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"User-specified colours"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Examples_drc_files/figure-html/unnamed-chunk-5-3.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## Plot of curves 1 and 2 only</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spinach.m1</span>, level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"User-specified curves"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Examples_drc_files/figure-html/unnamed-chunk-5-4.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhenglei Gao, Sean Ryan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>NOEC Calculation • drcHelper</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="NOEC Calculation">
<meta name="description" content="General ethods for NOEC calculations for dose-response studies
">
<meta property="og:description" content="General ethods for NOEC calculations for dose-response studies
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">drcHelper</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-getting-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Getting Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-getting-started">
<li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../Example_Analysis_workflow.html">Exampla Analysis Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/drcHelper.html">Package Dependencies</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/Examples_drc.html">Example Helper Functions</a></li>
    <li><a class="dropdown-item" href="../articles/EFSA-Criteria.html">EFSA Criteria and Other Reliability Criteria</a></li>
    <li><a class="dropdown-item" href="../articles/Example_RSCABS.html">RSCABS</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_oecd201.html">OECD 201</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Examples%20using%20NLS.html">NLS</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_using_drda.html">drda</a></li>
    <li><a class="dropdown-item" href="../articles/TSK_method.html">TSK method</a></li>
    <li><a class="dropdown-item" href="../articles/MQJT.html">MQJT</a></li>
    <li><a class="dropdown-item" href="../articles/Quantal-Data.html">Quantal Data</a></li>
    <li><a class="dropdown-item" href="../articles/Ordinal-Data.html">Ordinal Data</a></li>
    <li><a class="dropdown-item" href="../articles/Advanced_Fitting-a-biphasic-dose-reponse-model.html">Fitting A biphasic dose response model</a></li>
    <li><a class="dropdown-item" href="../articles/Count_Data.html">Count Data</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-validation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Validation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-validation">
<li><a class="dropdown-item" href="../articles/System_Testing.html">System Testing</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayer-Group/drcHelper/issues/new?template=Blank+issue" aria-label="New Issue"><span class="fa fa-bug"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayer-Group/drcHelper" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>NOEC Calculation</h1>
                        <h4 data-toc-skip class="author">Sarah Baumert,
Zhenglei Gao</h4>
            
            <h4 data-toc-skip class="date">December 4, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Bayer-Group/drcHelper/blob/main/vignettes/articles/NOEC_Methods.Rmd" class="external-link"><code>vignettes/articles/NOEC_Methods.Rmd</code></a></small>
      <div class="d-none name"><code>NOEC_Methods.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="dunnet-tests">Dunnet Tests<a class="anchor" aria-label="anchor" href="#dunnet-tests"></a>
</h2>
<p>Dunnett’s test is a multiple comparison test for determining
significant differences between the mean values of several test groups
and a control with normally distributed errors with homogeneous
variance. Dunnett’s test is robust to slight violations of the normality
and variance homogeneity assumptions.</p>
<p>There are several packages providing function for the calculation of
the Dunnett’s test. The function
“DunnettTest<code>from the library</code>DescTools<code>is calculating correct results for the "two.sided" direction. The function</code>dunnettTest<code>from the library</code>PMCMRplus<code>can be used to calculate the test options “less” (smaller), “greater” and "two.sided". The results for the "two.sided" option differ in some cases from the results of</code>DunnettTest<code>from the library “DescTools</code>.
The function</p>
</div>
<div class="section level2">
<h2 id="tamhane-dunnetts-test">Tamhane-Dunnett’s Test<a class="anchor" aria-label="anchor" href="#tamhane-dunnetts-test"></a>
</h2>
<p>For many-to-one comparisons in an one-factorial layout with normally
distributed residuals and unequal variances Tamhane-Dunnett’s test can
be used.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">245</span><span class="op">)</span></span>
<span><span class="va">mn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">^</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">mn</span>, each<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, each<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">x</span> <span class="op">~</span> <span class="va">g</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Shapiro-Wilk normality test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  residuals(fit)</span></span>
<span><span class="co">## W = 0.96609, p-value = 0.5484</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test</a></span><span class="op">(</span><span class="va">x</span> <span class="op">~</span> <span class="va">g</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Bartlett test of homogeneity of variances</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  x by g</span></span>
<span><span class="co">## Bartlett's K-squared = 1.0766, df = 4, p-value = 0.898</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Analysis of Variance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: x</span></span>
<span><span class="co">##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span><span class="co">## g          5 1761.11  352.22  171.01 1.069e-15 ***</span></span>
<span><span class="co">## Residuals 20   41.19    2.06                      </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## works with object of class aov</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">PMCMRplus</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/PMCMRplus/man/tamhaneDunnettTest.html" class="external-link">tamhaneDunnettTest</a></span><span class="op">(</span><span class="va">fit</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Pairwise comparisons using Tamhane-Dunnett's-test for multiple  </span></span>
<span><span class="co">##                          comparisons with one control</span></span></code></pre>
<pre><code><span><span class="co">## data: x by g</span></span></code></pre>
<pre><code><span><span class="co">## alternative hypothesis: greater</span></span></code></pre>
<pre><code><span><span class="co">## P value adjustment method: single-step</span></span></code></pre>
<pre><code><span><span class="co">## H0</span></span></code></pre>
<pre><code><span><span class="co">##            t value     Pr(&gt;t)    </span></span>
<span><span class="co">## 2 - 1 &lt;= 0   1.399 0.32792374    </span></span>
<span><span class="co">## 3 - 1 &lt;= 0   3.368 0.01849964   *</span></span>
<span><span class="co">## 4 - 1 &lt;= 0   7.223 0.00021346 ***</span></span>
<span><span class="co">## 5 - 1 &lt;= 0  15.186 3.5096e-09 ***</span></span></code></pre>
<pre><code><span><span class="co">## ---</span></span></code></pre>
<pre><code><span><span class="co">## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## summary(welchManyOneTTest(fit, alternative = "greater", p.adjust="single-step"))</span></span>
<span><span class="co">## p.adjust “holm”, “hochberg”, “hommel”, “bonferroni”, “BH”, “BY”, “fdr”, “none”</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/PMCMRplus/man/welchManyOneTTest.html" class="external-link">welchManyOneTTest</a></span><span class="op">(</span><span class="va">fit</span>, alternative <span class="op">=</span> <span class="st">"greater"</span>, p.adjust<span class="op">=</span><span class="st">"holm"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Pairwise comparisons using Welch's t-test</span></span></code></pre>
<pre><code><span><span class="co">## data: x by g</span></span></code></pre>
<pre><code><span><span class="co">## alternative hypothesis: greater</span></span></code></pre>
<pre><code><span><span class="co">## P value adjustment method: holm</span></span></code></pre>
<pre><code><span><span class="co">## H0</span></span></code></pre>
<pre><code><span><span class="co">##            t value     Pr(&gt;t)    </span></span>
<span><span class="co">## 2 - 1 &lt;= 0   1.399 0.10262533    </span></span>
<span><span class="co">## 3 - 1 &lt;= 0   3.368 0.01089476   *</span></span>
<span><span class="co">## 4 - 1 &lt;= 0   7.223 0.00013621 ***</span></span>
<span><span class="co">## 5 - 1 &lt;= 0  15.186 7.0276e-07 ***</span></span></code></pre>
<pre><code><span><span class="co">## ---</span></span></code></pre>
<pre><code><span><span class="co">## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/DunnettTest.html" class="external-link">DunnettTest</a></span><span class="op">(</span><span class="va">x</span><span class="op">~</span><span class="va">g</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span> <span class="co">## alternative is not taking effect in this case</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   Dunnett's test for comparing several treatments with a control :  </span></span>
<span><span class="co">##     95% family-wise confidence level</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`1`</span></span>
<span><span class="co">##          diff     lwr.ci    upr.ci    pval    </span></span>
<span><span class="co">## 2-1  1.201147 -1.2064128  3.608708  0.4992    </span></span>
<span><span class="co">## 3-1  3.041632  0.6340717  5.449192  0.0110 *  </span></span>
<span><span class="co">## 4-1  7.245476  4.8379162  9.653037 5.1e-08 ***</span></span>
<span><span class="co">## 5-1 15.611204 13.2036439 18.018764 &lt; 2e-16 ***</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">PMCMRplus</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PMCMRplus/man/dunnettTest.html" class="external-link">dunnettTest</a></span><span class="op">(</span><span class="va">x</span><span class="op">~</span><span class="va">g</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Pairwise comparisons using Dunnett's-test for multiple  </span></span>
<span><span class="co">##                          comparisons with one control</span></span></code></pre>
<pre><code><span><span class="co">## data: x by g</span></span></code></pre>
<pre><code><span><span class="co">##   1      </span></span>
<span><span class="co">## 2 0.511  </span></span>
<span><span class="co">## 3 0.012  </span></span>
<span><span class="co">## 4 1.2e-07</span></span>
<span><span class="co">## 5 &lt; 2e-16</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## P value adjustment method: single-step</span></span></code></pre>
<pre><code><span><span class="co">## alternative hypothesis: two.sided</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">PMCMRplus</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PMCMRplus/man/dunnettTest.html" class="external-link">dunnettTest</a></span><span class="op">(</span><span class="va">x</span><span class="op">~</span><span class="va">g</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Pairwise comparisons using Dunnett's-test for multiple  </span></span>
<span><span class="co">##                          comparisons with one control</span></span></code></pre>
<pre><code><span><span class="co">## data: x by g</span></span></code></pre>
<pre><code><span><span class="co">##   1      </span></span>
<span><span class="co">## 2 0.2554 </span></span>
<span><span class="co">## 3 0.0055 </span></span>
<span><span class="co">## 4 1.9e-08</span></span>
<span><span class="co">## 5 &lt; 2e-16</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## P value adjustment method: single-step</span></span></code></pre>
<pre><code><span><span class="co">## alternative hypothesis: greater</span></span></code></pre>
<p>DUNNETT C. W. (1955): A multiple comparison procedure for comparing
several treatments with a control, Journal of the American Statistical
Association, 50, pp. 1096-1121.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhenglei Gao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>

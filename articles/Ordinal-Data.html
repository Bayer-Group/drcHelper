<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>An example: RSCABS for Histopath Data â€¢ drcHelper</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An example: RSCABS for Histopath Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">drcHelper</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started">
<li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/drcHelper.html">Package Dependencies</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/Examples_drc.html">Example Helper Functions</a></li>
    <li><a class="dropdown-item" href="../articles/EFSA-Criteria.html">EFSA Criteria and Other Reliability Criteria</a></li>
    <li><a class="dropdown-item" href="../articles/Example_RSCABS.html">RSCABS</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_oecd201.html">OECD 201</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Examples%20using%20NLS.html">NLS</a></li>
    <li><a class="dropdown-item" href="../articles/Examples_using_drda.html">drda</a></li>
    <li><a class="dropdown-item" href="../articles/TSK_method.html">TSK method</a></li>
    <li><a class="dropdown-item" href="../articles/MQJT.html">MQJT</a></li>
    <li><a class="dropdown-item" href="../articles/Quantal-Data.html">Quantal Data</a></li>
    <li><a class="dropdown-item" href="../articles/Ordinal-Data.html">Ordinal Data</a></li>
    <li><a class="dropdown-item" href="../articles/Advanced_Fitting-a-biphasic-dose-reponse-model.html">Fitting A biphasic dose response model</a></li>
    <li><a class="dropdown-item" href="../articles/Count_Data.html">Count Data</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-validation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Validation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-validation">
<li><a class="dropdown-item" href="../articles/System_Testing.html">System Testing</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayer-Group/drcHelper/issues/new?template=Blank+issue" aria-label="New Issue"><span class="fa fa-bug"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Bayer-Group/drcHelper" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>An example: RSCABS for Histopath Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Bayer-Group/drcHelper/blob/main/vignettes/articles/Ordinal-Data.Rmd" class="external-link"><code>vignettes/articles/Ordinal-Data.Rmd</code></a></small>
      <div class="d-none name"><code>Ordinal-Data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
</div>
<div class="section level2">
<h2 id="an-example-of-performing-the-rao-scott-adjusted-cochran-armitage-trend-test-by-slices-">An example of performing the Rao-Scott Adjusted Cochran-Armitage
Trend Test by Slices.<a class="anchor" aria-label="anchor" href="#an-example-of-performing-the-rao-scott-adjusted-cochran-armitage-trend-test-by-slices-"></a>
</h2>
<p>RSCABS: designed to analyze histopathological results from standard
toxicology experiments, for example the MEOGRT.</p>
<p>Steps in the testing procedure:</p>
<p>1.The Cochran-Armitage (CA) trend test was used to test a set of
organisms for an increase in the presences (score &gt; 0) or absence
(score = 0) of an effect with an increase in the dose concentration of
the treatments. 2. The Rao-Scott (RS) adjustment controls for the
similarity in each experiment unit / apparatus (<em>e.g.</em>, fish
tank) by calculating an adjustment to the CA test statistic from
correlation of organisms within each apparatuses. 3. The by slices (BS)
part allows for testing at each severity score (<em>e.g.</em>, from 1 to
5) instead of just presences or absence. By slices works by splitting
the severity scores associated with an endpoint into
<strong>two</strong> groups based on the severity score being tested.
The RSCA test statistic is calculated based on these two groups. 4.
Carry out a step-down procedure by excluding the highest treatment level
in the analysis and recalculate the RSCA test statistic until the test
stats is not significant or there is only control group left.</p>
<div class="section level3">
<h3 id="notes-on-rscabs">Notes on RSCABS<a class="anchor" aria-label="anchor" href="#notes-on-rscabs"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Select responses maximum value should be &gt; 0 and smaller than
20??</li>
<li>for each to be tested response/endpoints,
<em>convert2score</em>
</li>
<li>for each to be tested response/endpoints, <em>prepDataRSCABS</em>,
prepare the data into matrix/table format, treatment as column,
replicate as row</li>
<li>for each to be tested response/endpoints, <em>stepKRSCABS</em>.</li>
</ol>
<pre><code>$Gon_Asynch_Dev
           Effect Treatment R.Score Statistic     P.Value Signif
1 Gon_Asynch_Dev1         5       1  2.622022 0.004370488     **
2 Gon_Asynch_Dev1         4       1       NaN 1.000000000      .
3 Gon_Asynch_Dev1         4       1       NaN 1.000000000      .
4 Gon_Asynch_Dev2         5       2  2.622022 0.004370488     **
5 Gon_Asynch_Dev2         4       2       NaN 1.000000000      .
6 Gon_Asynch_Dev2         4       2       NaN 1.000000000      .</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>combine the results into a big matrix.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://effective-adventure-2klnejq.pages.github.io/" class="external-link">drcHelper</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: drc</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: MASS</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## 'drc' has been loaded.</span></span></code></pre>
<pre><code><span><span class="co">## Please cite R and 'drc' if used for a publication,</span></span></code></pre>
<pre><code><span><span class="co">## for references type 'citation()' and 'citation('drc')'.</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'drc'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     gaussian, getInitial</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare data</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## â”€â”€ <span style="font-weight: bold;">Attaching core tidyverse packages</span> â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€</span></span>
<span><span class="co">## <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">## <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">## <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">ggplot2  </span> 3.5.1     <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">## <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">lubridate</span> 1.9.4     <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">## <span style="color: #00BB00;">âœ”</span> <span style="color: #0000BB;">purrr    </span> 1.0.2</span></span></code></pre>
<pre><code><span><span class="co">## â”€â”€ <span style="font-weight: bold;">Conflicts</span> â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€</span></span>
<span><span class="co">## <span style="color: #BB0000;">âœ–</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">## <span style="color: #BB0000;">âœ–</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">## <span style="color: #BB0000;">âœ–</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">select()</span> masks <span style="color: #0000BB;">MASS</span>::select()</span></span>
<span><span class="co">## <span style="color: #00BBBB;">â„¹</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://effective-adventure-2klnejq.pages.github.io/" class="external-link">drcHelper</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"exampleHistData"</span><span class="op">)</span></span>
<span><span class="va">exampleHistData</span> <span class="op">&lt;-</span> <span class="va">exampleHistData</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as_tibble</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.integer</span><span class="op">)</span>,<span class="va">as.numeric</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span>
<span><span class="co">#Take the subset corresponding to F0-females of 16 weeks of age</span></span>
<span></span>
<span><span class="va">subIndex</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">exampleHistData</span><span class="op">$</span><span class="va">Generation</span><span class="op">==</span><span class="st">'F2'</span> <span class="op">&amp;</span></span>
<span>                  <span class="va">exampleHistData</span><span class="op">$</span><span class="va">Genotypic_Sex</span><span class="op">==</span><span class="st">'Female'</span> <span class="op">&amp;</span></span>
<span>                  <span class="va">exampleHistData</span><span class="op">$</span><span class="va">Age</span><span class="op">==</span><span class="st">'16_wk'</span> <span class="op">)</span></span>
<span><span class="va">exampleHistData.Sub</span><span class="op">&lt;-</span><span class="va">exampleHistData</span><span class="op">[</span><span class="va">subIndex</span>, <span class="op">]</span></span>
<span><span class="co">#Run RSCABS </span></span>
<span><span class="va">exampleResults</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/runRSCABS.html">runRSCABS</a></span><span class="op">(</span><span class="va">exampleHistData.Sub</span>,<span class="st">'Treatment'</span>,</span>
<span>                          <span class="st">'Replicate'</span>,test.type<span class="op">=</span><span class="st">'RS'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exampleResults</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">.</span>,digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="36%">
<col width="14%">
<col width="11%">
<col width="14%">
<col width="11%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">Effect</th>
<th align="right">Treatment</th>
<th align="right">R.Score</th>
<th align="right">Statistic</th>
<th align="right">P.Value</th>
<th align="left">Signif</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Gon_Incr_Oocyte_Atresia1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">1.330</td>
<td align="right">0.092</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Gon_Incr_Oocyte_Atresia1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">1.330</td>
<td align="right">0.092</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Gon_Incr_Oocyte_Atresia2</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">1.231</td>
<td align="right">0.109</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Gon_Incr_Oocyte_Atresia2</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">1.231</td>
<td align="right">0.109</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Gon_Incr_Oocyte_Atresia3</td>
<td align="right">5</td>
<td align="right">3</td>
<td align="right">1.231</td>
<td align="right">0.109</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Gon_Incr_Oocyte_Atresia3</td>
<td align="right">5</td>
<td align="right">3</td>
<td align="right">1.231</td>
<td align="right">0.109</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Gon_Incr_Oocyte_Atresia4</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">1.231</td>
<td align="right">0.109</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Gon_Incr_Oocyte_Atresia4</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">1.231</td>
<td align="right">0.109</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Gon_Proteinaceous_fluid1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">-1.410</td>
<td align="right">0.079</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Gon_Proteinaceous_fluid1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">-1.410</td>
<td align="right">0.079</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Gon_Asynch_Dev1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">2.622</td>
<td align="right">0.004</td>
<td align="left">**</td>
</tr>
<tr class="even">
<td align="left">Gon_Asynch_Dev2</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">2.622</td>
<td align="right">0.004</td>
<td align="left">**</td>
</tr>
<tr class="odd">
<td align="left">Kid_Tub_Mineralization1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">0.358</td>
<td align="right">0.360</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Kid_Tub_Mineralization1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">0.358</td>
<td align="right">0.360</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Kid_Tub_Mineralization2</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">-0.070</td>
<td align="right">0.472</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Kid_Tub_Mineralization2</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">-0.070</td>
<td align="right">0.472</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Kid_Tub_Dilation1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">-0.070</td>
<td align="right">0.472</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Kid_Tub_Dilation1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">-0.070</td>
<td align="right">0.472</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Kid_Tub_Dilation2</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">-0.049</td>
<td align="right">0.480</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Kid_Tub_Dilation2</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">-0.049</td>
<td align="right">0.480</td>
<td align="left">.</td>
</tr>
<tr class="odd">
<td align="left">Kid_Tub_Regeneration1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">-1.375</td>
<td align="right">0.085</td>
<td align="left">.</td>
</tr>
<tr class="even">
<td align="left">Kid_Tub_Regeneration1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">-1.375</td>
<td align="right">0.085</td>
<td align="left">.</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">exampleHistData.Sub</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Treatment</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Gon_Asynch_Dev</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Example Data: Gon_Asynch_Dev"</span>,subtitle <span class="op">=</span> <span class="st">"subset: F2 generation, 15 week age and female"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Ordinal-Data_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># xlab&lt;-'Group'</span></span>
<span><span class="co"># ylab&lt;-'Total Fish'</span></span>
<span><span class="co"># main&lt;-'Example Graph for \n Example Data and Gon_Asynch_Dev'</span></span>
<span><span class="co"># col&lt;-c('purple1','red3')</span></span>
<span><span class="co"># Metric="Total"</span></span>
<span><span class="co"># Lowest ="Include"</span></span>
<span><span class="co"># # PlotParms&lt;-list()</span></span>
<span><span class="co"># # PlotParms$xlab&lt;-'Group'</span></span>
<span><span class="co"># # PlotParms$ylab&lt;-'Total Fish'</span></span>
<span><span class="co"># # PlotParms$main&lt;-'Example Graph for \n Example Data and Gon_Asynch_Dev'</span></span>
<span><span class="co"># # PlotParms$Colors&lt;-c('purple1','red3')</span></span>
<span><span class="co"># plotRSCABS(Data=exampleHistData.Sub, Effect="Gon_Asynch_Dev",</span></span>
<span><span class="co">#   Treatment="Treatment", Metric="Total", Lowest = "Include",</span></span>
<span><span class="co">#   #PlotParms =PlotParms,</span></span>
<span><span class="co">#   Format = NULL, File = NULL,</span></span>
<span><span class="co">#   xlab=xlab,main=main,ylab=ylab,col=col)</span></span>
<span><span class="co"># ####################</span></span>
<span><span class="co"># col &lt;- c("purple","green","black")</span></span>
<span><span class="co"># plotRSCABS(Data=exampleHistData.Sub, Effect="Gon_Incr_Oocyte_Atresia",</span></span>
<span><span class="co">#   Treatment="Treatment", Metric="Total", Lowest = "Include",</span></span>
<span><span class="co">#   #PlotParms =PlotParms, </span></span>
<span><span class="co">#   Format = NULL, File = NULL,</span></span>
<span><span class="co">#   xlab=xlab,main=main,ylab=ylab,col=col)</span></span>
<span><span class="va">cids</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">exampleHistData.Sub</span><span class="op">[</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span>,<span class="fl">2</span>,<span class="va">max</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">responses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cids</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">exampleHistData.Sub</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">+</span><span class="va">cids</span><span class="op">)</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,values_to <span class="op">=</span> <span class="st">"Response"</span>,names_to <span class="op">=</span> <span class="st">"Endpoint"</span><span class="op">)</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Treatment</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Response</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Example Histopath Data"</span>,subtitle <span class="op">=</span> <span class="st">"subset: F2 generation, 15 week age and female"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Endpoint</span><span class="op">)</span></span></code></pre></div>
<p><img src="Ordinal-Data_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'scales'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:purrr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     discard</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:readr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     col_factor</span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="va">exampleHistData.Sub</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">+</span><span class="va">cids</span><span class="op">)</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,values_to <span class="op">=</span> <span class="st">"Response"</span>,names_to <span class="op">=</span> <span class="st">"Endpoint"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Endpoint</span>,<span class="va">Treatment</span>,<span class="va">Response</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>counts<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Endpoint</span>,<span class="va">Treatment</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>total<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">counts</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'Endpoint', 'Treatment'. You can override</span></span>
<span><span class="co">#&gt; using the `.groups` argument.</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat1</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Treatment</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Response</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">counts</span><span class="op">/</span><span class="va">total</span><span class="op">)</span>,stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Example Histopath Data"</span>,subtitle <span class="op">=</span> <span class="st">"subset: F2 generation, 15 week age and female"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Endpoint</span>,drop <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">percent</span><span class="op">)</span></span></code></pre></div>
<p><img src="Ordinal-Data_files/figure-html/unnamed-chunk-5-3.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DependenciesGraphs</span><span class="op">)</span></span>
<span><span class="va">dep</span> <span class="op">&lt;-</span> <span class="fu">funDependencies</span><span class="op">(</span><span class="st">"package:drcHelper"</span>, <span class="st">"runRSCABS"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dep</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Agresti, A. (2002) Categorical Data Analysis, Second Edition.
Hoboken, New Jersey: John Wiley &amp; Sons, Inc.</li>
<li>Harrell, F. E, (2001) Regression Modeling Strategies. New York:
Springer-Verlag.</li>
<li><a href="http://www.sthda.com/english/articles/32-r-graphics-essentials/132-plot-grouped-data-box-plot-bar-plot-and-more/" class="external-link uri">http://www.sthda.com/english/articles/32-r-graphics-essentials/132-plot-grouped-data-box-plot-bar-plot-and-more/</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="multi-quantile-jt">Multi-quantile JT<a class="anchor" aria-label="anchor" href="#multi-quantile-jt"></a>
</h2>
<p>From: John Green, personal communication.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zhenglei Gao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
